var $i=Object.defineProperty;var Mi=(e,t,n)=>t in e?$i(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var $=(e,t,n)=>(Mi(e,typeof t!="symbol"?t+"":t,n),n);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerpolicy&&(a.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?a.credentials="include":i.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(i){if(i.ep)return;i.ep=!0;const a=n(i);fetch(i.href,a)}})();const V={};function Fi(e){V.context=e}const Ni=(e,t)=>e===t,se=Symbol("solid-proxy"),wn=Symbol("solid-track"),zt={equals:Ni};let Fr=Vr;const Ke=1,Ut=2,Nr={owned:null,cleanups:null,context:null,owner:null};var U=null;let Me=null,N=null,Y=null,ge=null,Qn=0;function Mt(e,t){const n=N,r=U,i=e.length===0,a=i?Nr:{owned:null,cleanups:null,context:null,owner:t||r},o=i?e:()=>e(()=>Re(()=>sn(a)));U=a,N=null;try{return tt(o,!0)}finally{N=n,U=r}}function Le(e,t){t=t?Object.assign({},zt,t):zt;const n={value:e,observers:null,observerSlots:null,comparator:t.equals||void 0},r=i=>(typeof i=="function"&&(i=i(n.value)),Hr(n,i));return[jr.bind(n),r]}function re(e,t,n){const r=Jn(e,t,!1,Ke);xt(r)}function on(e,t,n){Fr=Ui;const r=Jn(e,t,!1,Ke);r.user=!0,ge?ge.push(r):xt(r)}function ke(e,t,n){n=n?Object.assign({},zt,n):zt;const r=Jn(e,t,!0,0);return r.observers=null,r.observerSlots=null,r.comparator=n.equals||void 0,xt(r),jr.bind(r)}function Li(e){return tt(e,!1)}function Re(e){const t=N;N=null;try{return e()}finally{N=t}}function ji(e,t,n){const r=Array.isArray(e);let i,a=n&&n.defer;return o=>{let s;if(r){s=Array(e.length);for(let l=0;l<e.length;l++)s[l]=e[l]()}else s=e();if(a){a=!1;return}const u=Re(()=>t(s,i,o));return i=s,u}}function Hi(e){on(()=>Re(e))}function qn(e){return U===null||(U.cleanups===null?U.cleanups=[e]:U.cleanups.push(e)),e}function Lr(){return N}function jr(){const e=Me;if(this.sources&&(this.state||e))if(this.state===Ke||e)xt(this);else{const t=Y;Y=null,tt(()=>Gt(this),!1),Y=t}if(N){const t=this.observers?this.observers.length:0;N.sources?(N.sources.push(this),N.sourceSlots.push(t)):(N.sources=[this],N.sourceSlots=[t]),this.observers?(this.observers.push(N),this.observerSlots.push(N.sources.length-1)):(this.observers=[N],this.observerSlots=[N.sources.length-1])}return this.value}function Hr(e,t,n){let r=e.value;return(!e.comparator||!e.comparator(r,t))&&(e.value=t,e.observers&&e.observers.length&&tt(()=>{for(let i=0;i<e.observers.length;i+=1){const a=e.observers[i],o=Me&&Me.running;o&&Me.disposed.has(a),(o&&!a.tState||!o&&!a.state)&&(a.pure?Y.push(a):ge.push(a),a.observers&&zr(a)),o||(a.state=Ke)}if(Y.length>1e6)throw Y=[],new Error},!1)),t}function xt(e){if(!e.fn)return;sn(e);const t=U,n=N,r=Qn;N=U=e,Vi(e,e.value,r),N=n,U=t}function Vi(e,t,n){let r;try{r=e.fn(t)}catch(i){e.pure&&(e.state=Ke,e.owned&&e.owned.forEach(sn),e.owned=null),Ur(i)}(!e.updatedAt||e.updatedAt<=n)&&(e.updatedAt!=null&&"observers"in e?Hr(e,r):e.value=r,e.updatedAt=n)}function Jn(e,t,n,r=Ke,i){const a={fn:e,state:r,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:t,owner:U,context:null,pure:n};return U===null||U!==Nr&&(U.owned?U.owned.push(a):U.owned=[a]),a}function Wt(e){const t=Me;if(e.state===0||t)return;if(e.state===Ut||t)return Gt(e);if(e.suspense&&Re(e.suspense.inFallback))return e.suspense.effects.push(e);const n=[e];for(;(e=e.owner)&&(!e.updatedAt||e.updatedAt<Qn);)(e.state||t)&&n.push(e);for(let r=n.length-1;r>=0;r--)if(e=n[r],e.state===Ke||t)xt(e);else if(e.state===Ut||t){const i=Y;Y=null,tt(()=>Gt(e,n[0]),!1),Y=i}}function tt(e,t){if(Y)return e();let n=!1;t||(Y=[]),ge?n=!0:ge=[],Qn++;try{const r=e();return zi(n),r}catch(r){Y||(ge=null),Ur(r)}}function zi(e){if(Y&&(Vr(Y),Y=null),e)return;const t=ge;ge=null,t.length&&tt(()=>Fr(t),!1)}function Vr(e){for(let t=0;t<e.length;t++)Wt(e[t])}function Ui(e){let t,n=0;for(t=0;t<e.length;t++){const r=e[t];r.user?e[n++]=r:Wt(r)}for(V.context&&Fi(),t=0;t<n;t++)Wt(e[t])}function Gt(e,t){const n=Me;e.state=0;for(let r=0;r<e.sources.length;r+=1){const i=e.sources[r];i.sources&&(i.state===Ke||n?i!==t&&Wt(i):(i.state===Ut||n)&&Gt(i,t))}}function zr(e){const t=Me;for(let n=0;n<e.observers.length;n+=1){const r=e.observers[n];(!r.state||t)&&(r.state=Ut,r.pure?Y.push(r):ge.push(r),r.observers&&zr(r))}}function sn(e){let t;if(e.sources)for(;e.sources.length;){const n=e.sources.pop(),r=e.sourceSlots.pop(),i=n.observers;if(i&&i.length){const a=i.pop(),o=n.observerSlots.pop();r<i.length&&(a.sourceSlots[o]=r,i[r]=a,n.observerSlots[r]=o)}}if(e.owned){for(t=0;t<e.owned.length;t++)sn(e.owned[t]);e.owned=null}if(e.cleanups){for(t=0;t<e.cleanups.length;t++)e.cleanups[t]();e.cleanups=null}e.state=0,e.context=null}function Wi(e){return e instanceof Error||typeof e=="string"?e:new Error("Unknown error")}function Ur(e){throw e=Wi(e),e}const Gi=Symbol("fallback");function gr(e){for(let t=0;t<e.length;t++)e[t]()}function Yi(e,t,n={}){let r=[],i=[],a=[],o=0,s=t.length>1?[]:null;return qn(()=>gr(a)),()=>{let u=e()||[],l,c;return u[wn],Re(()=>{let h=u.length,y,p,d,v,g,_,b,w,m;if(h===0)o!==0&&(gr(a),a=[],r=[],i=[],o=0,s&&(s=[])),n.fallback&&(r=[Gi],i[0]=Mt(x=>(a[0]=x,n.fallback())),o=1);else if(o===0){for(i=new Array(h),c=0;c<h;c++)r[c]=u[c],i[c]=Mt(f);o=h}else{for(d=new Array(h),v=new Array(h),s&&(g=new Array(h)),_=0,b=Math.min(o,h);_<b&&r[_]===u[_];_++);for(b=o-1,w=h-1;b>=_&&w>=_&&r[b]===u[w];b--,w--)d[w]=i[b],v[w]=a[b],s&&(g[w]=s[b]);for(y=new Map,p=new Array(w+1),c=w;c>=_;c--)m=u[c],l=y.get(m),p[c]=l===void 0?-1:l,y.set(m,c);for(l=_;l<=b;l++)m=r[l],c=y.get(m),c!==void 0&&c!==-1?(d[c]=i[l],v[c]=a[l],s&&(g[c]=s[l]),c=p[c],y.set(m,c)):a[l]();for(c=_;c<h;c++)c in d?(i[c]=d[c],a[c]=v[c],s&&(s[c]=g[c],s[c](c))):i[c]=Mt(f);i=i.slice(0,o=h),r=u.slice(0)}return i});function f(h){if(a[c]=h,s){const[y,p]=Le(c);return s[c]=p,t(u[c],y)}return t(u[c])}}}function ve(e,t){return Re(()=>e(t||{}))}function Dt(){return!0}const _n={get(e,t,n){return t===se?n:e.get(t)},has(e,t){return t===se?!0:e.has(t)},set:Dt,deleteProperty:Dt,getOwnPropertyDescriptor(e,t){return{configurable:!0,enumerable:!0,get(){return e.get(t)},set:Dt,deleteProperty:Dt}},ownKeys(e){return e.keys()}};function hn(e){return(e=typeof e=="function"?e():e)?e:{}}function Xi(...e){let t=!1;for(let r=0;r<e.length;r++){const i=e[r];t=t||!!i&&se in i,e[r]=typeof i=="function"?(t=!0,ke(i)):i}if(t)return new Proxy({get(r){for(let i=e.length-1;i>=0;i--){const a=hn(e[i])[r];if(a!==void 0)return a}},has(r){for(let i=e.length-1;i>=0;i--)if(r in hn(e[i]))return!0;return!1},keys(){const r=[];for(let i=0;i<e.length;i++)r.push(...Object.keys(hn(e[i])));return[...new Set(r)]}},_n);const n={};for(let r=e.length-1;r>=0;r--)if(e[r]){const i=Object.getOwnPropertyDescriptors(e[r]);for(const a in i)a in n||Object.defineProperty(n,a,{enumerable:!0,get(){for(let o=e.length-1;o>=0;o--){const s=(e[o]||{})[a];if(s!==void 0)return s}}})}return n}function Qi(e,...t){const n=new Set(t.flat());if(se in e){const i=t.map(a=>new Proxy({get(o){return a.includes(o)?e[o]:void 0},has(o){return a.includes(o)&&o in e},keys(){return a.filter(o=>o in e)}},_n));return i.push(new Proxy({get(a){return n.has(a)?void 0:e[a]},has(a){return n.has(a)?!1:a in e},keys(){return Object.keys(e).filter(a=>!n.has(a))}},_n)),i}const r=Object.getOwnPropertyDescriptors(e);return t.push(Object.keys(r).filter(i=>!n.has(i))),t.map(i=>{const a={};for(let o=0;o<i.length;o++){const s=i[o];s in e&&Object.defineProperty(a,s,r[s]?r[s]:{get(){return e[s]},set(){return!0},enumerable:!0})}return a})}function qi(e){const t="fallback"in e&&{fallback:()=>e.fallback};return ke(Yi(()=>e.each,e.children,t||void 0))}const Ji=["allowfullscreen","async","autofocus","autoplay","checked","controls","default","disabled","formnovalidate","hidden","indeterminate","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","seamless","selected"],Zi=new Set(["className","value","readOnly","formNoValidate","isMap","noModule","playsInline",...Ji]),ea=new Set(["innerHTML","textContent","innerText","children"]),ta=Object.assign(Object.create(null),{className:"class",htmlFor:"for"}),br=Object.assign(Object.create(null),{class:"className",formnovalidate:"formNoValidate",ismap:"isMap",nomodule:"noModule",playsinline:"playsInline",readonly:"readOnly"}),na=new Set(["beforeinput","click","dblclick","contextmenu","focusin","focusout","input","keydown","keyup","mousedown","mousemove","mouseout","mouseover","mouseup","pointerdown","pointermove","pointerout","pointerover","pointerup","touchend","touchmove","touchstart"]),ra=new Set(["altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignObject","g","glyph","glyphRef","hkern","image","line","linearGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","set","stop","svg","switch","symbol","text","textPath","tref","tspan","use","view","vkern"]),ia={xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace"};function aa(e,t,n){let r=n.length,i=t.length,a=r,o=0,s=0,u=t[i-1].nextSibling,l=null;for(;o<i||s<a;){if(t[o]===n[s]){o++,s++;continue}for(;t[i-1]===n[a-1];)i--,a--;if(i===o){const c=a<r?s?n[s-1].nextSibling:n[a-s]:u;for(;s<a;)e.insertBefore(n[s++],c)}else if(a===s)for(;o<i;)(!l||!l.has(t[o]))&&t[o].remove(),o++;else if(t[o]===n[a-1]&&n[s]===t[i-1]){const c=t[--i].nextSibling;e.insertBefore(n[s++],t[o++].nextSibling),e.insertBefore(n[--a],c),t[i]=n[a]}else{if(!l){l=new Map;let f=s;for(;f<a;)l.set(n[f],f++)}const c=l.get(t[o]);if(c!=null)if(s<c&&c<a){let f=o,h=1,y;for(;++f<i&&f<a&&!((y=l.get(t[f]))==null||y!==c+h);)h++;if(h>c-s){const p=t[o];for(;s<c;)e.insertBefore(n[s++],p)}else e.replaceChild(n[s++],t[o++])}else o++;else t[o++].remove()}}}const wr="_$DX_DELEGATE";function oa(e,t,n,r={}){let i;return Mt(a=>{i=a,t===document?e():j(t,e(),t.firstChild?null:void 0,n)},r.owner),()=>{i(),t.textContent=""}}function q(e,t,n){const r=document.createElement("template");r.innerHTML=e;let i=r.content.firstChild;return n&&(i=i.firstChild),i}function At(e,t=window.document){const n=t[wr]||(t[wr]=new Set);for(let r=0,i=e.length;r<i;r++){const a=e[r];n.has(a)||(n.add(a),t.addEventListener(a,ha))}}function Xe(e,t,n){n==null?e.removeAttribute(t):e.setAttribute(t,n)}function sa(e,t,n,r){r==null?e.removeAttributeNS(t,n):e.setAttributeNS(t,n,r)}function ua(e,t){t==null?e.removeAttribute("class"):e.className=t}function Yt(e,t,n,r){if(r)Array.isArray(n)?(e[`$$${t}`]=n[0],e[`$$${t}Data`]=n[1]):e[`$$${t}`]=n;else if(Array.isArray(n)){const i=n[0];e.addEventListener(t,n[0]=a=>i.call(e,n[1],a))}else e.addEventListener(t,n)}function Wr(e,t,n={}){const r=Object.keys(t||{}),i=Object.keys(n);let a,o;for(a=0,o=i.length;a<o;a++){const s=i[a];!s||s==="undefined"||t[s]||(_r(e,s,!1),delete n[s])}for(a=0,o=r.length;a<o;a++){const s=r[a],u=!!t[s];!s||s==="undefined"||n[s]===u||!u||(_r(e,s,!0),n[s]=u)}return n}function Gr(e,t,n){if(!t)return n?Xe(e,"style"):t;const r=e.style;if(typeof t=="string")return r.cssText=t;typeof n=="string"&&(r.cssText=n=void 0),n||(n={}),t||(t={});let i,a;for(a in n)t[a]==null&&r.removeProperty(a),delete n[a];for(a in t)i=t[a],i!==n[a]&&(r.setProperty(a,i),n[a]=i);return n}function Yr(e,t={},n,r){const i={};return r||re(()=>i.children=Je(e,t.children,i.children)),re(()=>t.ref&&t.ref(e)),re(()=>la(e,t,n,!0,i,!0)),i}function Xt(e,t,n){return Re(()=>e(t,n))}function j(e,t,n,r){if(n!==void 0&&!r&&(r=[]),typeof t!="function")return Je(e,t,r,n);re(i=>Je(e,t(),i,n),r)}function la(e,t,n,r,i={},a=!1){t||(t={});for(const o in i)if(!(o in t)){if(o==="children")continue;i[o]=xr(e,o,null,i[o],n,a)}for(const o in t){if(o==="children"){r||Je(e,t.children);continue}const s=t[o];i[o]=xr(e,o,s,i[o],n,a)}}function ca(e){let t,n;return!V.context||!(t=V.registry.get(n=da()))?e.cloneNode(!0):(V.completed&&V.completed.add(t),V.registry.delete(n),t)}function fa(e){return e.toLowerCase().replace(/-([a-z])/g,(t,n)=>n.toUpperCase())}function _r(e,t,n){const r=t.trim().split(/\s+/);for(let i=0,a=r.length;i<a;i++)e.classList.toggle(r[i],n)}function xr(e,t,n,r,i,a){let o,s,u;if(t==="style")return Gr(e,n,r);if(t==="classList")return Wr(e,n,r);if(n===r)return r;if(t==="ref")a||n(e);else if(t.slice(0,3)==="on:"){const l=t.slice(3);r&&e.removeEventListener(l,r),n&&e.addEventListener(l,n)}else if(t.slice(0,10)==="oncapture:"){const l=t.slice(10);r&&e.removeEventListener(l,r,!0),n&&e.addEventListener(l,n,!0)}else if(t.slice(0,2)==="on"){const l=t.slice(2).toLowerCase(),c=na.has(l);if(!c&&r){const f=Array.isArray(r)?r[0]:r;e.removeEventListener(l,f)}(c||n)&&(Yt(e,l,n,c),c&&At([l]))}else if((u=ea.has(t))||!i&&(br[t]||(s=Zi.has(t)))||(o=e.nodeName.includes("-")))t==="class"||t==="className"?ua(e,n):o&&!s&&!u?e[fa(t)]=n:e[br[t]||t]=n;else{const l=i&&t.indexOf(":")>-1&&ia[t.split(":")[0]];l?sa(e,l,t,n):Xe(e,ta[t]||t,n)}return n}function ha(e){const t=`$$${e.type}`;let n=e.composedPath&&e.composedPath()[0]||e.target;for(e.target!==n&&Object.defineProperty(e,"target",{configurable:!0,value:n}),Object.defineProperty(e,"currentTarget",{configurable:!0,get(){return n||document}}),V.registry&&!V.done&&(V.done=!0,document.querySelectorAll("[id^=pl-]").forEach(r=>{for(;r&&r.nodeType!==8&&r.nodeValue!=="pl-"+e;){let i=r.nextSibling;r.remove(),r=i}r&&r.remove()}));n;){const r=n[t];if(r&&!n.disabled){const i=n[`${t}Data`];if(i!==void 0?r.call(n,i,e):r.call(n,e),e.cancelBubble)return}n=n._$host||n.parentNode||n.host}}function Je(e,t,n,r,i){for(V.context&&!n&&(n=[...e.childNodes]);typeof n=="function";)n=n();if(t===n)return n;const a=typeof t,o=r!==void 0;if(e=o&&n[0]&&n[0].parentNode||e,a==="string"||a==="number"){if(V.context)return n;if(a==="number"&&(t=t.toString()),o){let s=n[0];s&&s.nodeType===3?s.data=t:s=document.createTextNode(t),n=ze(e,n,r,s)}else n!==""&&typeof n=="string"?n=e.firstChild.data=t:n=e.textContent=t}else if(t==null||a==="boolean"){if(V.context)return n;n=ze(e,n,r)}else{if(a==="function")return re(()=>{let s=t();for(;typeof s=="function";)s=s();n=Je(e,s,n,r)}),()=>n;if(Array.isArray(t)){const s=[],u=n&&Array.isArray(n);if(xn(s,t,n,i))return re(()=>n=Je(e,s,n,r,!0)),()=>n;if(V.context){if(!s.length)return n;for(let l=0;l<s.length;l++)if(s[l].parentNode)return n=s}if(s.length===0){if(n=ze(e,n,r),o)return n}else u?n.length===0?Ar(e,s,r):aa(e,n,s):(n&&ze(e),Ar(e,s));n=s}else if(t instanceof Node){if(V.context&&t.parentNode)return n=o?[t]:t;if(Array.isArray(n)){if(o)return n=ze(e,n,r,t);ze(e,n,null,t)}else n==null||n===""||!e.firstChild?e.appendChild(t):e.replaceChild(t,e.firstChild);n=t}}return n}function xn(e,t,n,r){let i=!1;for(let a=0,o=t.length;a<o;a++){let s=t[a],u=n&&n[a];if(s instanceof Node)e.push(s);else if(!(s==null||s===!0||s===!1))if(Array.isArray(s))i=xn(e,s,u)||i;else if(typeof s=="function")if(r){for(;typeof s=="function";)s=s();i=xn(e,Array.isArray(s)?s:[s],Array.isArray(u)?u:[u])||i}else e.push(s),i=!0;else{const l=String(s);u&&u.nodeType===3&&u.data===l?e.push(u):e.push(document.createTextNode(l))}}return i}function Ar(e,t,n=null){for(let r=0,i=t.length;r<i;r++)e.insertBefore(t[r],n)}function ze(e,t,n,r){if(n===void 0)return e.textContent="";const i=r||document.createTextNode("");if(t.length){let a=!1;for(let o=t.length-1;o>=0;o--){const s=t[o];if(i!==s){const u=s.parentNode===e;!a&&!o?u?e.replaceChild(i,s):e.insertBefore(i,n):u&&s.remove()}else a=!0}}else e.insertBefore(i,n);return[i]}function da(){const e=V.context;return`${e.id}${e.count++}`}const pa=!1,va="http://www.w3.org/2000/svg";function ya(e,t=!1){return t?document.createElementNS(va,e):document.createElement(e)}function ma(e){const[t,n]=Qi(e,["component"]),r=ke(()=>t.component);return ke(()=>{const i=r();switch(typeof i){case"function":return Re(()=>i(n));case"string":const a=ra.has(i),o=V.context?ca():ya(i,a);return Yr(o,n,a),o}})}class ga{constructor(){$(this,"_bindings",[])}attach(...t){this._bindings.push(...t)}detach(...t){this._bindings=this._bindings.filter(n=>!t.includes(n))}fire(t,n){this._bindings.forEach(r=>{r(t,n)})}}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.
Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.
THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var D=function(){return D=Object.assign||function(t){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},D.apply(this,arguments)};function An(e,t,n){if(n||arguments.length===2)for(var r=0,i=t.length,a;r<i;r++)(a||!(r in t))&&(a||(a=Array.prototype.slice.call(t,0,r)),a[r]=t[r]);return e.concat(a||Array.prototype.slice.call(t))}var M=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,L=Object.keys,G=Array.isArray;typeof Promise<"u"&&!M.Promise&&(M.Promise=Promise);function Q(e,t){return typeof t!="object"||L(t).forEach(function(n){e[n]=t[n]}),e}var dt=Object.getPrototypeOf,ba={}.hasOwnProperty;function Z(e,t){return ba.call(e,t)}function Ze(e,t){typeof t=="function"&&(t=t(dt(e))),(typeof Reflect>"u"?L:Reflect.ownKeys)(t).forEach(function(n){we(e,n,t[n])})}var Xr=Object.defineProperty;function we(e,t,n,r){Xr(e,t,Q(n&&Z(n,"get")&&typeof n.get=="function"?{get:n.get,set:n.set,configurable:!0}:{value:n,configurable:!0,writable:!0},r))}function nt(e){return{from:function(t){return e.prototype=Object.create(t.prototype),we(e.prototype,"constructor",e),{extend:Ze.bind(null,e.prototype)}}}}var wa=Object.getOwnPropertyDescriptor;function Zn(e,t){var n=wa(e,t),r;return n||(r=dt(e))&&Zn(r,t)}var _a=[].slice;function un(e,t,n){return _a.call(e,t,n)}function Qr(e,t){return t(e)}function st(e){if(!e)throw new Error("Assertion Failed")}function qr(e){M.setImmediate?setImmediate(e):setTimeout(e,0)}function Jr(e,t){return e.reduce(function(n,r,i){var a=t(r,i);return a&&(n[a[0]]=a[1]),n},{})}function xa(e,t,n){try{e.apply(null,n)}catch(r){t&&t(r)}}function be(e,t){if(Z(e,t))return e[t];if(!t)return e;if(typeof t!="string"){for(var n=[],r=0,i=t.length;r<i;++r){var a=be(e,t[r]);n.push(a)}return n}var o=t.indexOf(".");if(o!==-1){var s=e[t.substr(0,o)];return s===void 0?void 0:be(s,t.substr(o+1))}}function oe(e,t,n){if(!(!e||t===void 0)&&!("isFrozen"in Object&&Object.isFrozen(e)))if(typeof t!="string"&&"length"in t){st(typeof n!="string"&&"length"in n);for(var r=0,i=t.length;r<i;++r)oe(e,t[r],n[r])}else{var a=t.indexOf(".");if(a!==-1){var o=t.substr(0,a),s=t.substr(a+1);if(s==="")n===void 0?G(e)&&!isNaN(parseInt(o))?e.splice(o,1):delete e[o]:e[o]=n;else{var u=e[o];(!u||!Z(e,o))&&(u=e[o]={}),oe(u,s,n)}}else n===void 0?G(e)&&!isNaN(parseInt(t))?e.splice(t,1):delete e[t]:e[t]=n}}function Aa(e,t){typeof t=="string"?oe(e,t,void 0):"length"in t&&[].map.call(t,function(n){oe(e,n,void 0)})}function Zr(e){var t={};for(var n in e)Z(e,n)&&(t[n]=e[n]);return t}var Ea=[].concat;function ei(e){return Ea.apply([],e)}var ti="Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(ei([8,16,32,64].map(function(e){return["Int","Uint","Float"].map(function(t){return t+e+"Array"})}))).filter(function(e){return M[e]}),Sa=ti.map(function(e){return M[e]});Jr(ti,function(e){return[e,!0]});var Se=null;function Et(e){Se=typeof WeakMap<"u"&&new WeakMap;var t=En(e);return Se=null,t}function En(e){if(!e||typeof e!="object")return e;var t=Se&&Se.get(e);if(t)return t;if(G(e)){t=[],Se&&Se.set(e,t);for(var n=0,r=e.length;n<r;++n)t.push(En(e[n]))}else if(Sa.indexOf(e.constructor)>=0)t=e;else{var i=dt(e);t=i===Object.prototype?{}:Object.create(i),Se&&Se.set(e,t);for(var a in e)Z(e,a)&&(t[a]=En(e[a]))}return t}var Ca={}.toString;function Sn(e){return Ca.call(e).slice(8,-1)}var Cn=typeof Symbol<"u"?Symbol.iterator:"@@iterator",ka=typeof Cn=="symbol"?function(e){var t;return e!=null&&(t=e[Cn])&&t.apply(e)}:function(){return null},Ge={};function ye(e){var t,n,r,i;if(arguments.length===1){if(G(e))return e.slice();if(this===Ge&&typeof e=="string")return[e];if(i=ka(e)){for(n=[];r=i.next(),!r.done;)n.push(r.value);return n}if(e==null)return[e];if(t=e.length,typeof t=="number"){for(n=new Array(t);t--;)n[t]=e[t];return n}return[e]}for(t=arguments.length,n=new Array(t);t--;)n[t]=arguments[t];return n}var er=typeof Symbol<"u"?function(e){return e[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},he=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function ni(e,t){he=e,ri=t}var ri=function(){return!0},Pa=!new Error("").stack;function Ve(){if(Pa)try{throw Ve.arguments,new Error}catch(e){return e}return new Error}function kn(e,t){var n=e.stack;return n?(t=t||0,n.indexOf(e.name)===0&&(t+=(e.name+e.message).split(`
`).length),n.split(`
`).slice(t).filter(ri).map(function(r){return`
`+r}).join("")):""}var Ta=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"],ii=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],tr=Ta.concat(ii),Oa={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function rt(e,t){this._e=Ve(),this.name=e,this.message=t}nt(rt).from(Error).extend({stack:{get:function(){return this._stack||(this._stack=this.name+": "+this.message+kn(this._e,2))}},toString:function(){return this.name+": "+this.message}});function ai(e,t){return e+". Errors: "+Object.keys(t).map(function(n){return t[n].toString()}).filter(function(n,r,i){return i.indexOf(n)===r}).join(`
`)}function Qt(e,t,n,r){this._e=Ve(),this.failures=t,this.failedKeys=r,this.successCount=n,this.message=ai(e,t)}nt(Qt).from(rt);function ct(e,t){this._e=Ve(),this.name="BulkError",this.failures=Object.keys(t).map(function(n){return t[n]}),this.failuresByPos=t,this.message=ai(e,t)}nt(ct).from(rt);var nr=tr.reduce(function(e,t){return e[t]=t+"Error",e},{}),Da=rt,P=tr.reduce(function(e,t){var n=t+"Error";function r(i,a){this._e=Ve(),this.name=n,i?typeof i=="string"?(this.message=""+i+(a?`
 `+a:""),this.inner=a||null):typeof i=="object"&&(this.message=i.name+" "+i.message,this.inner=i):(this.message=Oa[t]||n,this.inner=null)}return nt(r).from(Da),e[t]=r,e},{});P.Syntax=SyntaxError;P.Type=TypeError;P.Range=RangeError;var Er=ii.reduce(function(e,t){return e[t+"Error"]=P[t],e},{});function Ka(e,t){if(!e||e instanceof rt||e instanceof TypeError||e instanceof SyntaxError||!e.name||!Er[e.name])return e;var n=new Er[e.name](t||e.message,e);return"stack"in e&&we(n,"stack",{get:function(){return this.inner.stack}}),n}var ln=tr.reduce(function(e,t){return["Syntax","Type","Range"].indexOf(t)===-1&&(e[t+"Error"]=P[t]),e},{});ln.ModifyError=Qt;ln.DexieError=rt;ln.BulkError=ct;function B(){}function St(e){return e}function Ra(e,t){return e==null||e===St?t:function(n){return t(e(n))}}function je(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function Ia(e,t){return e===B?t:function(){var n=e.apply(this,arguments);n!==void 0&&(arguments[0]=n);var r=this.onsuccess,i=this.onerror;this.onsuccess=null,this.onerror=null;var a=t.apply(this,arguments);return r&&(this.onsuccess=this.onsuccess?je(r,this.onsuccess):r),i&&(this.onerror=this.onerror?je(i,this.onerror):i),a!==void 0?a:n}}function Ba(e,t){return e===B?t:function(){e.apply(this,arguments);var n=this.onsuccess,r=this.onerror;this.onsuccess=this.onerror=null,t.apply(this,arguments),n&&(this.onsuccess=this.onsuccess?je(n,this.onsuccess):n),r&&(this.onerror=this.onerror?je(r,this.onerror):r)}}function $a(e,t){return e===B?t:function(n){var r=e.apply(this,arguments);Q(n,r);var i=this.onsuccess,a=this.onerror;this.onsuccess=null,this.onerror=null;var o=t.apply(this,arguments);return i&&(this.onsuccess=this.onsuccess?je(i,this.onsuccess):i),a&&(this.onerror=this.onerror?je(a,this.onerror):a),r===void 0?o===void 0?void 0:o:Q(r,o)}}function Ma(e,t){return e===B?t:function(){return t.apply(this,arguments)===!1?!1:e.apply(this,arguments)}}function rr(e,t){return e===B?t:function(){var n=e.apply(this,arguments);if(n&&typeof n.then=="function"){for(var r=this,i=arguments.length,a=new Array(i);i--;)a[i]=arguments[i];return n.then(function(){return t.apply(r,a)})}return t.apply(this,arguments)}}var pt={},Fa=100,Na=20,oi=100,ir=typeof Promise>"u"?[]:function(){var e=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[e,dt(e),e];var t=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[t,dt(t),e]}(),Pn=ir[0],qt=ir[1],Tn=ir[2],si=qt&&qt.then,Ft=Pn&&Pn.constructor,ar=!!Tn,On=!1,La=Tn?function(){Tn.then(Kt)}:M.setImmediate?setImmediate.bind(null,Kt):M.MutationObserver?function(){var e=document.createElement("div");new MutationObserver(function(){Kt(),e=null}).observe(e,{attributes:!0}),e.setAttribute("i","1")}:function(){setTimeout(Kt,0)},vt=function(e,t){ut.push([e,t]),Jt&&(La(),Jt=!1)},Dn=!0,Jt=!0,Fe=[],Nt=[],Kn=null,Rn=St,Qe={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:kr,pgp:!1,env:{},finalize:function(){this.unhandleds.forEach(function(e){try{kr(e[0],e[1])}catch{}})}},S=Qe,ut=[],Ne=0,Lt=[];function E(e){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this.onuncatched=B,this._lib=!1;var t=this._PSD=S;if(he&&(this._stackHolder=Ve(),this._prev=null,this._numPrev=0),typeof e!="function"){if(e!==pt)throw new TypeError("Not a function");this._state=arguments[1],this._value=arguments[2],this._state===!1&&Bn(this,this._value);return}this._state=null,this._value=null,++t.ref,li(this,e)}var In={get:function(){var e=S,t=Zt;function n(r,i){var a=this,o=!e.global&&(e!==S||t!==Zt),s=o&&!_e(),u=new E(function(l,c){or(a,new ui(tn(r,e,o,s),tn(i,e,o,s),l,c,e))});return he&&hi(u,this),u}return n.prototype=pt,n},set:function(e){we(this,"then",e&&e.prototype===pt?In:{get:function(){return e},set:In.set})}};Ze(E.prototype,{then:In,_then:function(e,t){or(this,new ui(null,null,e,t,S))},catch:function(e){if(arguments.length===1)return this.then(null,e);var t=arguments[0],n=arguments[1];return typeof t=="function"?this.then(null,function(r){return r instanceof t?n(r):jt(r)}):this.then(null,function(r){return r&&r.name===t?n(r):jt(r)})},finally:function(e){return this.then(function(t){return e(),t},function(t){return e(),jt(t)})},stack:{get:function(){if(this._stack)return this._stack;try{On=!0;var e=fi(this,[],Na),t=e.join(`
From previous: `);return this._state!==null&&(this._stack=t),t}finally{On=!1}}},timeout:function(e,t){var n=this;return e<1/0?new E(function(r,i){var a=setTimeout(function(){return i(new P.Timeout(t))},e);n.then(r,i).finally(clearTimeout.bind(null,a))}):this}});typeof Symbol<"u"&&Symbol.toStringTag&&we(E.prototype,Symbol.toStringTag,"Dexie.Promise");Qe.env=di();function ui(e,t,n,r,i){this.onFulfilled=typeof e=="function"?e:null,this.onRejected=typeof t=="function"?t:null,this.resolve=n,this.reject=r,this.psd=i}Ze(E,{all:function(){var e=ye.apply(null,arguments).map(en);return new E(function(t,n){e.length===0&&t([]);var r=e.length;e.forEach(function(i,a){return E.resolve(i).then(function(o){e[a]=o,--r||t(e)},n)})})},resolve:function(e){if(e instanceof E)return e;if(e&&typeof e.then=="function")return new E(function(n,r){e.then(n,r)});var t=new E(pt,!0,e);return hi(t,Kn),t},reject:jt,race:function(){var e=ye.apply(null,arguments).map(en);return new E(function(t,n){e.map(function(r){return E.resolve(r).then(t,n)})})},PSD:{get:function(){return S},set:function(e){return S=e}},totalEchoes:{get:function(){return Zt}},newPSD:Pe,usePSD:at,scheduler:{get:function(){return vt},set:function(e){vt=e}},rejectionMapper:{get:function(){return Rn},set:function(e){Rn=e}},follow:function(e,t){return new E(function(n,r){return Pe(function(i,a){var o=S;o.unhandleds=[],o.onunhandled=a,o.finalize=je(function(){var s=this;Ha(function(){s.unhandleds.length===0?i():a(s.unhandleds[0])})},o.finalize),e()},t,n,r)})}});Ft&&(Ft.allSettled&&we(E,"allSettled",function(){var e=ye.apply(null,arguments).map(en);return new E(function(t){e.length===0&&t([]);var n=e.length,r=new Array(n);e.forEach(function(i,a){return E.resolve(i).then(function(o){return r[a]={status:"fulfilled",value:o}},function(o){return r[a]={status:"rejected",reason:o}}).then(function(){return--n||t(r)})})})}),Ft.any&&typeof AggregateError<"u"&&we(E,"any",function(){var e=ye.apply(null,arguments).map(en);return new E(function(t,n){e.length===0&&n(new AggregateError([]));var r=e.length,i=new Array(r);e.forEach(function(a,o){return E.resolve(a).then(function(s){return t(s)},function(s){i[o]=s,--r||n(new AggregateError(i))})})})}));function li(e,t){try{t(function(n){if(e._state===null){if(n===e)throw new TypeError("A promise cannot be resolved with itself.");var r=e._lib&&Ct();n&&typeof n.then=="function"?li(e,function(i,a){n instanceof E?n._then(i,a):n.then(i,a)}):(e._state=!0,e._value=n,ci(e)),r&&kt()}},Bn.bind(null,e))}catch(n){Bn(e,n)}}function Bn(e,t){if(Nt.push(t),e._state===null){var n=e._lib&&Ct();t=Rn(t),e._state=!1,e._value=t,he&&t!==null&&typeof t=="object"&&!t._promise&&xa(function(){var r=Zn(t,"stack");t._promise=e,we(t,"stack",{get:function(){return On?r&&(r.get?r.get.apply(t):r.value):e.stack}})}),Va(e),ci(e),n&&kt()}}function ci(e){var t=e._listeners;e._listeners=[];for(var n=0,r=t.length;n<r;++n)or(e,t[n]);var i=e._PSD;--i.ref||i.finalize(),Ne===0&&(++Ne,vt(function(){--Ne===0&&sr()},[]))}function or(e,t){if(e._state===null){e._listeners.push(t);return}var n=e._state?t.onFulfilled:t.onRejected;if(n===null)return(e._state?t.resolve:t.reject)(e._value);++t.psd.ref,++Ne,vt(ja,[n,e,t])}function ja(e,t,n){try{Kn=t;var r,i=t._value;t._state?r=e(i):(Nt.length&&(Nt=[]),r=e(i),Nt.indexOf(i)===-1&&za(t)),n.resolve(r)}catch(a){n.reject(a)}finally{Kn=null,--Ne===0&&sr(),--n.psd.ref||n.psd.finalize()}}function fi(e,t,n){if(t.length===n)return t;var r="";if(e._state===!1){var i=e._value,a,o;i!=null?(a=i.name||"Error",o=i.message||i,r=kn(i,0)):(a=i,o=""),t.push(a+(o?": "+o:"")+r)}return he&&(r=kn(e._stackHolder,2),r&&t.indexOf(r)===-1&&t.push(r),e._prev&&fi(e._prev,t,n)),t}function hi(e,t){var n=t?t._numPrev+1:0;n<Fa&&(e._prev=t,e._numPrev=n)}function Kt(){Ct()&&kt()}function Ct(){var e=Dn;return Dn=!1,Jt=!1,e}function kt(){var e,t,n;do for(;ut.length>0;)for(e=ut,ut=[],n=e.length,t=0;t<n;++t){var r=e[t];r[0].apply(null,r[1])}while(ut.length>0);Dn=!0,Jt=!0}function sr(){var e=Fe;Fe=[],e.forEach(function(r){r._PSD.onunhandled.call(null,r._value,r)});for(var t=Lt.slice(0),n=t.length;n;)t[--n]()}function Ha(e){function t(){e(),Lt.splice(Lt.indexOf(t),1)}Lt.push(t),++Ne,vt(function(){--Ne===0&&sr()},[])}function Va(e){Fe.some(function(t){return t._value===e._value})||Fe.push(e)}function za(e){for(var t=Fe.length;t;)if(Fe[--t]._value===e._value){Fe.splice(t,1);return}}function jt(e){return new E(pt,!1,e)}function F(e,t){var n=S;return function(){var r=Ct(),i=S;try{return Te(n,!0),e.apply(this,arguments)}catch(a){t&&t(a)}finally{Te(i,!1),r&&kt()}}}var W={awaits:0,echoes:0,id:0},Ua=0,Ht=[],dn=0,Zt=0,Wa=0;function Pe(e,t,n,r){var i=S,a=Object.create(i);a.parent=i,a.ref=0,a.global=!1,a.id=++Wa;var o=Qe.env;a.env=ar?{Promise:E,PromiseProp:{value:E,configurable:!0,writable:!0},all:E.all,race:E.race,allSettled:E.allSettled,any:E.any,resolve:E.resolve,reject:E.reject,nthen:Sr(o.nthen,a),gthen:Sr(o.gthen,a)}:{},t&&Q(a,t),++i.ref,a.finalize=function(){--this.parent.ref||this.parent.finalize()};var s=at(a,e,n,r);return a.ref===0&&a.finalize(),s}function it(){return W.id||(W.id=++Ua),++W.awaits,W.echoes+=oi,W.id}function _e(){return W.awaits?(--W.awaits===0&&(W.id=0),W.echoes=W.awaits*oi,!0):!1}(""+si).indexOf("[native code]")===-1&&(it=_e=B);function en(e){return W.echoes&&e&&e.constructor===Ft?(it(),e.then(function(t){return _e(),t},function(t){return _e(),H(t)})):e}function Ga(e){++Zt,(!W.echoes||--W.echoes===0)&&(W.echoes=W.id=0),Ht.push(S),Te(e,!0)}function Ya(){var e=Ht[Ht.length-1];Ht.pop(),Te(e,!1)}function Te(e,t){var n=S;if((t?W.echoes&&(!dn++||e!==S):dn&&(!--dn||e!==S))&&pi(t?Ga.bind(null,e):Ya),e!==S&&(S=e,n===Qe&&(Qe.env=di()),ar)){var r=Qe.env.Promise,i=e.env;qt.then=i.nthen,r.prototype.then=i.gthen,(n.global||e.global)&&(Object.defineProperty(M,"Promise",i.PromiseProp),r.all=i.all,r.race=i.race,r.resolve=i.resolve,r.reject=i.reject,i.allSettled&&(r.allSettled=i.allSettled),i.any&&(r.any=i.any))}}function di(){var e=M.Promise;return ar?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor(M,"Promise"),all:e.all,race:e.race,allSettled:e.allSettled,any:e.any,resolve:e.resolve,reject:e.reject,nthen:qt.then,gthen:e.prototype.then}:{}}function at(e,t,n,r,i){var a=S;try{return Te(e,!0),t(n,r,i)}finally{Te(a,!1)}}function pi(e){si.call(Pn,e)}function tn(e,t,n,r){return typeof e!="function"?e:function(){var i=S;n&&it(),Te(t,!0);try{return e.apply(this,arguments)}finally{Te(i,!1),r&&pi(_e)}}}function Sr(e,t){return function(n,r){return e.call(this,tn(n,t),tn(r,t))}}var Cr="unhandledrejection";function kr(e,t){var n;try{n=t.onuncatched(e)}catch{}if(n!==!1)try{var r,i={promise:t,reason:e};if(M.document&&document.createEvent?(r=document.createEvent("Event"),r.initEvent(Cr,!0,!0),Q(r,i)):M.CustomEvent&&(r=new CustomEvent(Cr,{detail:i}),Q(r,i)),r&&M.dispatchEvent&&(dispatchEvent(r),!M.PromiseRejectionEvent&&M.onunhandledrejection))try{M.onunhandledrejection(r)}catch{}he&&r&&!r.defaultPrevented&&console.warn("Unhandled rejection: "+(e.stack||e))}catch{}}var H=E.reject;function $n(e,t,n,r){if(!e.idbdb||!e._state.openComplete&&!S.letThrough&&!e._vip){if(e._state.openComplete)return H(new P.DatabaseClosed(e._state.dbOpenError));if(!e._state.isBeingOpened){if(!e._options.autoOpen)return H(new P.DatabaseClosed);e.open().catch(B)}return e._state.dbReadyPromise.then(function(){return $n(e,t,n,r)})}else{var i=e._createTransaction(t,n,e._dbSchema);try{i.create(),e._state.PR1398_maxLoop=3}catch(a){return a.name===nr.InvalidState&&e.isOpen()&&--e._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),e._close(),e.open().then(function(){return $n(e,t,n,r)})):H(a)}return i._promise(t,function(a,o){return Pe(function(){return S.trans=i,r(a,o,i)})}).then(function(a){return i._completion.then(function(){return a})})}}var Pr="3.2.2",$e=String.fromCharCode(65535),Mn=-1/0,de="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",vi="String expected.",ft=[],cn=typeof navigator<"u"&&/(MSIE|Trident|Edge)/.test(navigator.userAgent),Xa=cn,Qa=cn,yi=function(e){return!/(dexie\.js|dexie\.min\.js)/.test(e)},fn="__dbnames",pn="readonly",vn="readwrite";function He(e,t){return e?t?function(){return e.apply(this,arguments)&&t.apply(this,arguments)}:e:t}var mi={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Rt(e){return typeof e=="string"&&!/\./.test(e)?function(t){return t[e]===void 0&&e in t&&(t=Et(t),delete t[e]),t}:function(t){return t}}var qa=function(){function e(){}return e.prototype._trans=function(t,n,r){var i=this._tx||S.trans,a=this.name;function o(u,l,c){if(!c.schema[a])throw new P.NotFound("Table "+a+" not part of transaction");return n(c.idbtrans,c)}var s=Ct();try{return i&&i.db===this.db?i===S.trans?i._promise(t,o,r):Pe(function(){return i._promise(t,o,r)},{trans:i,transless:S.transless||S}):$n(this.db,t,[this.name],o)}finally{s&&kt()}},e.prototype.get=function(t,n){var r=this;return t&&t.constructor===Object?this.where(t).first(n):this._trans("readonly",function(i){return r.core.get({trans:i,key:t}).then(function(a){return r.hook.reading.fire(a)})}).then(n)},e.prototype.where=function(t){if(typeof t=="string")return new this.db.WhereClause(this,t);if(G(t))return new this.db.WhereClause(this,"["+t.join("+")+"]");var n=L(t);if(n.length===1)return this.where(n[0]).equals(t[n[0]]);var r=this.schema.indexes.concat(this.schema.primKey).filter(function(c){return c.compound&&n.every(function(f){return c.keyPath.indexOf(f)>=0})&&c.keyPath.every(function(f){return n.indexOf(f)>=0})})[0];if(r&&this.db._maxKey!==$e)return this.where(r.name).equals(r.keyPath.map(function(c){return t[c]}));!r&&he&&console.warn("The query "+JSON.stringify(t)+" on "+this.name+" would benefit of a "+("compound index ["+n.join("+")+"]"));var i=this.schema.idxByName,a=this.db._deps.indexedDB;function o(c,f){try{return a.cmp(c,f)===0}catch{return!1}}var s=n.reduce(function(c,f){var h=c[0],y=c[1],p=i[f],d=t[f];return[h||p,h||!p?He(y,p&&p.multi?function(v){var g=be(v,f);return G(g)&&g.some(function(_){return o(d,_)})}:function(v){return o(d,be(v,f))}):y]},[null,null]),u=s[0],l=s[1];return u?this.where(u.name).equals(t[u.keyPath]).filter(l):r?this.filter(l):this.where(n).equals("")},e.prototype.filter=function(t){return this.toCollection().and(t)},e.prototype.count=function(t){return this.toCollection().count(t)},e.prototype.offset=function(t){return this.toCollection().offset(t)},e.prototype.limit=function(t){return this.toCollection().limit(t)},e.prototype.each=function(t){return this.toCollection().each(t)},e.prototype.toArray=function(t){return this.toCollection().toArray(t)},e.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},e.prototype.orderBy=function(t){return new this.db.Collection(new this.db.WhereClause(this,G(t)?"["+t.join("+")+"]":t))},e.prototype.reverse=function(){return this.toCollection().reverse()},e.prototype.mapToClass=function(t){this.schema.mappedClass=t;var n=function(r){if(!r)return r;var i=Object.create(t.prototype);for(var a in r)if(Z(r,a))try{i[a]=r[a]}catch{}return i};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=n,this.hook("reading",n),t},e.prototype.defineClass=function(){function t(n){Q(this,n)}return this.mapToClass(t)},e.prototype.add=function(t,n){var r=this,i=this.schema.primKey,a=i.auto,o=i.keyPath,s=t;return o&&a&&(s=Rt(o)(t)),this._trans("readwrite",function(u){return r.core.mutate({trans:u,type:"add",keys:n!=null?[n]:null,values:[s]})}).then(function(u){return u.numFailures?E.reject(u.failures[0]):u.lastResult}).then(function(u){if(o)try{oe(t,o,u)}catch{}return u})},e.prototype.update=function(t,n){if(typeof t=="object"&&!G(t)){var r=be(t,this.schema.primKey.keyPath);if(r===void 0)return H(new P.InvalidArgument("Given object does not contain its primary key"));try{typeof n!="function"?L(n).forEach(function(i){oe(t,i,n[i])}):n(t,{value:t,primKey:r})}catch{}return this.where(":id").equals(r).modify(n)}else return this.where(":id").equals(t).modify(n)},e.prototype.put=function(t,n){var r=this,i=this.schema.primKey,a=i.auto,o=i.keyPath,s=t;return o&&a&&(s=Rt(o)(t)),this._trans("readwrite",function(u){return r.core.mutate({trans:u,type:"put",values:[s],keys:n!=null?[n]:null})}).then(function(u){return u.numFailures?E.reject(u.failures[0]):u.lastResult}).then(function(u){if(o)try{oe(t,o,u)}catch{}return u})},e.prototype.delete=function(t){var n=this;return this._trans("readwrite",function(r){return n.core.mutate({trans:r,type:"delete",keys:[t]})}).then(function(r){return r.numFailures?E.reject(r.failures[0]):void 0})},e.prototype.clear=function(){var t=this;return this._trans("readwrite",function(n){return t.core.mutate({trans:n,type:"deleteRange",range:mi})}).then(function(n){return n.numFailures?E.reject(n.failures[0]):void 0})},e.prototype.bulkGet=function(t){var n=this;return this._trans("readonly",function(r){return n.core.getMany({keys:t,trans:r}).then(function(i){return i.map(function(a){return n.hook.reading.fire(a)})})})},e.prototype.bulkAdd=function(t,n,r){var i=this,a=Array.isArray(n)?n:void 0;r=r||(a?void 0:n);var o=r?r.allKeys:void 0;return this._trans("readwrite",function(s){var u=i.schema.primKey,l=u.auto,c=u.keyPath;if(c&&a)throw new P.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(a&&a.length!==t.length)throw new P.InvalidArgument("Arguments objects and keys must have the same length");var f=t.length,h=c&&l?t.map(Rt(c)):t;return i.core.mutate({trans:s,type:"add",keys:a,values:h,wantResults:o}).then(function(y){var p=y.numFailures,d=y.results,v=y.lastResult,g=y.failures,_=o?d:v;if(p===0)return _;throw new ct(i.name+".bulkAdd(): "+p+" of "+f+" operations failed",g)})})},e.prototype.bulkPut=function(t,n,r){var i=this,a=Array.isArray(n)?n:void 0;r=r||(a?void 0:n);var o=r?r.allKeys:void 0;return this._trans("readwrite",function(s){var u=i.schema.primKey,l=u.auto,c=u.keyPath;if(c&&a)throw new P.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(a&&a.length!==t.length)throw new P.InvalidArgument("Arguments objects and keys must have the same length");var f=t.length,h=c&&l?t.map(Rt(c)):t;return i.core.mutate({trans:s,type:"put",keys:a,values:h,wantResults:o}).then(function(y){var p=y.numFailures,d=y.results,v=y.lastResult,g=y.failures,_=o?d:v;if(p===0)return _;throw new ct(i.name+".bulkPut(): "+p+" of "+f+" operations failed",g)})})},e.prototype.bulkDelete=function(t){var n=this,r=t.length;return this._trans("readwrite",function(i){return n.core.mutate({trans:i,type:"delete",keys:t})}).then(function(i){var a=i.numFailures,o=i.lastResult,s=i.failures;if(a===0)return o;throw new ct(n.name+".bulkDelete(): "+a+" of "+r+" operations failed",s)})},e}();function Pt(e){var t={},n=function(s,u){if(u){for(var l=arguments.length,c=new Array(l-1);--l;)c[l-1]=arguments[l];return t[s].subscribe.apply(null,c),e}else if(typeof s=="string")return t[s]};n.addEventType=a;for(var r=1,i=arguments.length;r<i;++r)a(arguments[r]);return n;function a(s,u,l){if(typeof s=="object")return o(s);u||(u=Ma),l||(l=B);var c={subscribers:[],fire:l,subscribe:function(f){c.subscribers.indexOf(f)===-1&&(c.subscribers.push(f),c.fire=u(c.fire,f))},unsubscribe:function(f){c.subscribers=c.subscribers.filter(function(h){return h!==f}),c.fire=c.subscribers.reduce(u,l)}};return t[s]=n[s]=c,c}function o(s){L(s).forEach(function(u){var l=s[u];if(G(l))a(u,s[u][0],s[u][1]);else if(l==="asap")var c=a(u,St,function(){for(var h=arguments.length,y=new Array(h);h--;)y[h]=arguments[h];c.subscribers.forEach(function(p){qr(function(){p.apply(null,y)})})});else throw new P.InvalidArgument("Invalid event config")})}}function Tt(e,t){return nt(t).from({prototype:e}),t}function Ja(e){return Tt(qa.prototype,function(n,r,i){this.db=e,this._tx=i,this.name=n,this.schema=r,this.hook=e._allTables[n]?e._allTables[n].hook:Pt(null,{creating:[Ia,B],reading:[Ra,St],updating:[$a,B],deleting:[Ba,B]})})}function Ue(e,t){return!(e.filter||e.algorithm||e.or)&&(t?e.justLimit:!e.replayFilter)}function yn(e,t){e.filter=He(e.filter,t)}function mn(e,t,n){var r=e.replayFilter;e.replayFilter=r?function(){return He(r(),t())}:t,e.justLimit=n&&!r}function Za(e,t){e.isMatch=He(e.isMatch,t)}function Vt(e,t){if(e.isPrimKey)return t.primaryKey;var n=t.getIndexByKeyPath(e.index);if(!n)throw new P.Schema("KeyPath "+e.index+" on object store "+t.name+" is not indexed");return n}function Tr(e,t,n){var r=Vt(e,t.schema);return t.openCursor({trans:n,values:!e.keysOnly,reverse:e.dir==="prev",unique:!!e.unique,query:{index:r,range:e.range}})}function It(e,t,n,r){var i=e.replayFilter?He(e.filter,e.replayFilter()):e.filter;if(e.or){var a={},o=function(s,u,l){if(!i||i(u,l,function(h){return u.stop(h)},function(h){return u.fail(h)})){var c=u.primaryKey,f=""+c;f==="[object ArrayBuffer]"&&(f=""+new Uint8Array(c)),Z(a,f)||(a[f]=!0,t(s,u,l))}};return Promise.all([e.or._iterate(o,n),Or(Tr(e,r,n),e.algorithm,o,!e.keysOnly&&e.valueMapper)])}else return Or(Tr(e,r,n),He(e.algorithm,i),t,!e.keysOnly&&e.valueMapper)}function Or(e,t,n,r){var i=r?function(o,s,u){return n(r(o),s,u)}:n,a=F(i);return e.then(function(o){if(o)return o.start(function(){var s=function(){return o.continue()};(!t||t(o,function(u){return s=u},function(u){o.stop(u),s=B},function(u){o.fail(u),s=B}))&&a(o.value,o,function(u){return s=u}),s()})})}function X(e,t){try{var n=Dr(e),r=Dr(t);if(n!==r)return n==="Array"?1:r==="Array"?-1:n==="binary"?1:r==="binary"?-1:n==="string"?1:r==="string"?-1:n==="Date"?1:r!=="Date"?NaN:-1;switch(n){case"number":case"Date":case"string":return e>t?1:e<t?-1:0;case"binary":return to(Kr(e),Kr(t));case"Array":return eo(e,t)}}catch{}return NaN}function eo(e,t){for(var n=e.length,r=t.length,i=n<r?n:r,a=0;a<i;++a){var o=X(e[a],t[a]);if(o!==0)return o}return n===r?0:n<r?-1:1}function to(e,t){for(var n=e.length,r=t.length,i=n<r?n:r,a=0;a<i;++a)if(e[a]!==t[a])return e[a]<t[a]?-1:1;return n===r?0:n<r?-1:1}function Dr(e){var t=typeof e;if(t!=="object")return t;if(ArrayBuffer.isView(e))return"binary";var n=Sn(e);return n==="ArrayBuffer"?"binary":n}function Kr(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)}var no=function(){function e(){}return e.prototype._read=function(t,n){var r=this._ctx;return r.error?r.table._trans(null,H.bind(null,r.error)):r.table._trans("readonly",t).then(n)},e.prototype._write=function(t){var n=this._ctx;return n.error?n.table._trans(null,H.bind(null,n.error)):n.table._trans("readwrite",t,"locked")},e.prototype._addAlgorithm=function(t){var n=this._ctx;n.algorithm=He(n.algorithm,t)},e.prototype._iterate=function(t,n){return It(this._ctx,t,n,this._ctx.table.core)},e.prototype.clone=function(t){var n=Object.create(this.constructor.prototype),r=Object.create(this._ctx);return t&&Q(r,t),n._ctx=r,n},e.prototype.raw=function(){return this._ctx.valueMapper=null,this},e.prototype.each=function(t){var n=this._ctx;return this._read(function(r){return It(n,t,r,n.table.core)})},e.prototype.count=function(t){var n=this;return this._read(function(r){var i=n._ctx,a=i.table.core;if(Ue(i,!0))return a.count({trans:r,query:{index:Vt(i,a.schema),range:i.range}}).then(function(s){return Math.min(s,i.limit)});var o=0;return It(i,function(){return++o,!1},r,a).then(function(){return o})}).then(t)},e.prototype.sortBy=function(t,n){var r=t.split(".").reverse(),i=r[0],a=r.length-1;function o(l,c){return c?o(l[r[c]],c-1):l[i]}var s=this._ctx.dir==="next"?1:-1;function u(l,c){var f=o(l,a),h=o(c,a);return f<h?-s:f>h?s:0}return this.toArray(function(l){return l.sort(u)}).then(n)},e.prototype.toArray=function(t){var n=this;return this._read(function(r){var i=n._ctx;if(i.dir==="next"&&Ue(i,!0)&&i.limit>0){var a=i.valueMapper,o=Vt(i,i.table.core.schema);return i.table.core.query({trans:r,limit:i.limit,values:!0,query:{index:o,range:i.range}}).then(function(u){var l=u.result;return a?l.map(a):l})}else{var s=[];return It(i,function(u){return s.push(u)},r,i.table.core).then(function(){return s})}},t)},e.prototype.offset=function(t){var n=this._ctx;return t<=0?this:(n.offset+=t,Ue(n)?mn(n,function(){var r=t;return function(i,a){return r===0?!0:r===1?(--r,!1):(a(function(){i.advance(r),r=0}),!1)}}):mn(n,function(){var r=t;return function(){return--r<0}}),this)},e.prototype.limit=function(t){return this._ctx.limit=Math.min(this._ctx.limit,t),mn(this._ctx,function(){var n=t;return function(r,i,a){return--n<=0&&i(a),n>=0}},!0),this},e.prototype.until=function(t,n){return yn(this._ctx,function(r,i,a){return t(r.value)?(i(a),n):!0}),this},e.prototype.first=function(t){return this.limit(1).toArray(function(n){return n[0]}).then(t)},e.prototype.last=function(t){return this.reverse().first(t)},e.prototype.filter=function(t){return yn(this._ctx,function(n){return t(n.value)}),Za(this._ctx,t),this},e.prototype.and=function(t){return this.filter(t)},e.prototype.or=function(t){return new this.db.WhereClause(this._ctx.table,t,this)},e.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},e.prototype.desc=function(){return this.reverse()},e.prototype.eachKey=function(t){var n=this._ctx;return n.keysOnly=!n.isMatch,this.each(function(r,i){t(i.key,i)})},e.prototype.eachUniqueKey=function(t){return this._ctx.unique="unique",this.eachKey(t)},e.prototype.eachPrimaryKey=function(t){var n=this._ctx;return n.keysOnly=!n.isMatch,this.each(function(r,i){t(i.primaryKey,i)})},e.prototype.keys=function(t){var n=this._ctx;n.keysOnly=!n.isMatch;var r=[];return this.each(function(i,a){r.push(a.key)}).then(function(){return r}).then(t)},e.prototype.primaryKeys=function(t){var n=this._ctx;if(n.dir==="next"&&Ue(n,!0)&&n.limit>0)return this._read(function(i){var a=Vt(n,n.table.core.schema);return n.table.core.query({trans:i,values:!1,limit:n.limit,query:{index:a,range:n.range}})}).then(function(i){var a=i.result;return a}).then(t);n.keysOnly=!n.isMatch;var r=[];return this.each(function(i,a){r.push(a.primaryKey)}).then(function(){return r}).then(t)},e.prototype.uniqueKeys=function(t){return this._ctx.unique="unique",this.keys(t)},e.prototype.firstKey=function(t){return this.limit(1).keys(function(n){return n[0]}).then(t)},e.prototype.lastKey=function(t){return this.reverse().firstKey(t)},e.prototype.distinct=function(){var t=this._ctx,n=t.index&&t.table.schema.idxByName[t.index];if(!n||!n.multi)return this;var r={};return yn(this._ctx,function(i){var a=i.primaryKey.toString(),o=Z(r,a);return r[a]=!0,!o}),this},e.prototype.modify=function(t){var n=this,r=this._ctx;return this._write(function(i){var a;if(typeof t=="function")a=t;else{var o=L(t),s=o.length;a=function(g){for(var _=!1,b=0;b<s;++b){var w=o[b],m=t[w];be(g,w)!==m&&(oe(g,w,m),_=!0)}return _}}var u=r.table.core,l=u.schema.primaryKey,c=l.outbound,f=l.extractKey,h=n.db._options.modifyChunkSize||200,y=[],p=0,d=[],v=function(g,_){var b=_.failures,w=_.numFailures;p+=g-w;for(var m=0,x=L(b);m<x.length;m++){var C=x[m];y.push(b[C])}};return n.clone().primaryKeys().then(function(g){var _=function(b){var w=Math.min(h,g.length-b);return u.getMany({trans:i,keys:g.slice(b,b+w),cache:"immutable"}).then(function(m){for(var x=[],C=[],A=c?[]:null,k=[],T=0;T<w;++T){var R=m[T],I={value:Et(R),primKey:g[b+T]};a.call(I,I.value,I)!==!1&&(I.value==null?k.push(g[b+T]):!c&&X(f(R),f(I.value))!==0?(k.push(g[b+T]),x.push(I.value)):(C.push(I.value),c&&A.push(g[b+T])))}var K=Ue(r)&&r.limit===1/0&&(typeof t!="function"||t===gn)&&{index:r.index,range:r.range};return Promise.resolve(x.length>0&&u.mutate({trans:i,type:"add",values:x}).then(function(z){for(var O in z.failures)k.splice(parseInt(O),1);v(x.length,z)})).then(function(){return(C.length>0||K&&typeof t=="object")&&u.mutate({trans:i,type:"put",keys:A,values:C,criteria:K,changeSpec:typeof t!="function"&&t}).then(function(z){return v(C.length,z)})}).then(function(){return(k.length>0||K&&t===gn)&&u.mutate({trans:i,type:"delete",keys:k,criteria:K}).then(function(z){return v(k.length,z)})}).then(function(){return g.length>b+w&&_(b+h)})})};return _(0).then(function(){if(y.length>0)throw new Qt("Error modifying one or more objects",y,p,d);return g.length})})})},e.prototype.delete=function(){var t=this._ctx,n=t.range;return Ue(t)&&(t.isPrimKey&&!Qa||n.type===3)?this._write(function(r){var i=t.table.core.schema.primaryKey,a=n;return t.table.core.count({trans:r,query:{index:i,range:a}}).then(function(o){return t.table.core.mutate({trans:r,type:"deleteRange",range:a}).then(function(s){var u=s.failures;s.lastResult,s.results;var l=s.numFailures;if(l)throw new Qt("Could not delete some values",Object.keys(u).map(function(c){return u[c]}),o-l);return o-l})})}):this.modify(gn)},e}(),gn=function(e,t){return t.value=null};function ro(e){return Tt(no.prototype,function(n,r){this.db=e;var i=mi,a=null;if(r)try{i=r()}catch(l){a=l}var o=n._ctx,s=o.table,u=s.hook.reading.fire;this._ctx={table:s,index:o.index,isPrimKey:!o.index||s.schema.primKey.keyPath&&o.index===s.schema.primKey.name,range:i,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:a,or:o.or,valueMapper:u!==St?u:null}})}function io(e,t){return e<t?-1:e===t?0:1}function ao(e,t){return e>t?-1:e===t?0:1}function J(e,t,n){var r=e instanceof bi?new e.Collection(e):e;return r._ctx.error=n?new n(t):new TypeError(t),r}function We(e){return new e.Collection(e,function(){return gi("")}).limit(0)}function oo(e){return e==="next"?function(t){return t.toUpperCase()}:function(t){return t.toLowerCase()}}function so(e){return e==="next"?function(t){return t.toLowerCase()}:function(t){return t.toUpperCase()}}function uo(e,t,n,r,i,a){for(var o=Math.min(e.length,r.length),s=-1,u=0;u<o;++u){var l=t[u];if(l!==r[u])return i(e[u],n[u])<0?e.substr(0,u)+n[u]+n.substr(u+1):i(e[u],r[u])<0?e.substr(0,u)+r[u]+n.substr(u+1):s>=0?e.substr(0,s)+t[s]+n.substr(s+1):null;i(e[u],l)<0&&(s=u)}return o<r.length&&a==="next"?e+n.substr(e.length):o<e.length&&a==="prev"?e.substr(0,n.length):s<0?null:e.substr(0,s)+r[s]+n.substr(s+1)}function Bt(e,t,n,r){var i,a,o,s,u,l,c,f=n.length;if(!n.every(function(d){return typeof d=="string"}))return J(e,vi);function h(d){i=oo(d),a=so(d),o=d==="next"?io:ao;var v=n.map(function(g){return{lower:a(g),upper:i(g)}}).sort(function(g,_){return o(g.lower,_.lower)});s=v.map(function(g){return g.upper}),u=v.map(function(g){return g.lower}),l=d,c=d==="next"?"":r}h("next");var y=new e.Collection(e,function(){return Ee(s[0],u[f-1]+r)});y._ondirectionchange=function(d){h(d)};var p=0;return y._addAlgorithm(function(d,v,g){var _=d.key;if(typeof _!="string")return!1;var b=a(_);if(t(b,u,p))return!0;for(var w=null,m=p;m<f;++m){var x=uo(_,b,s[m],u[m],o,l);x===null&&w===null?p=m+1:(w===null||o(w,x)>0)&&(w=x)}return v(w!==null?function(){d.continue(w+c)}:g),!1}),y}function Ee(e,t,n,r){return{type:2,lower:e,upper:t,lowerOpen:n,upperOpen:r}}function gi(e){return{type:1,lower:e,upper:e}}var bi=function(){function e(){}return Object.defineProperty(e.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),e.prototype.between=function(t,n,r,i){r=r!==!1,i=i===!0;try{return this._cmp(t,n)>0||this._cmp(t,n)===0&&(r||i)&&!(r&&i)?We(this):new this.Collection(this,function(){return Ee(t,n,!r,!i)})}catch{return J(this,de)}},e.prototype.equals=function(t){return t==null?J(this,de):new this.Collection(this,function(){return gi(t)})},e.prototype.above=function(t){return t==null?J(this,de):new this.Collection(this,function(){return Ee(t,void 0,!0)})},e.prototype.aboveOrEqual=function(t){return t==null?J(this,de):new this.Collection(this,function(){return Ee(t,void 0,!1)})},e.prototype.below=function(t){return t==null?J(this,de):new this.Collection(this,function(){return Ee(void 0,t,!1,!0)})},e.prototype.belowOrEqual=function(t){return t==null?J(this,de):new this.Collection(this,function(){return Ee(void 0,t)})},e.prototype.startsWith=function(t){return typeof t!="string"?J(this,vi):this.between(t,t+$e,!0,!0)},e.prototype.startsWithIgnoreCase=function(t){return t===""?this.startsWith(t):Bt(this,function(n,r){return n.indexOf(r[0])===0},[t],$e)},e.prototype.equalsIgnoreCase=function(t){return Bt(this,function(n,r){return n===r[0]},[t],"")},e.prototype.anyOfIgnoreCase=function(){var t=ye.apply(Ge,arguments);return t.length===0?We(this):Bt(this,function(n,r){return r.indexOf(n)!==-1},t,"")},e.prototype.startsWithAnyOfIgnoreCase=function(){var t=ye.apply(Ge,arguments);return t.length===0?We(this):Bt(this,function(n,r){return r.some(function(i){return n.indexOf(i)===0})},t,$e)},e.prototype.anyOf=function(){var t=this,n=ye.apply(Ge,arguments),r=this._cmp;try{n.sort(r)}catch{return J(this,de)}if(n.length===0)return We(this);var i=new this.Collection(this,function(){return Ee(n[0],n[n.length-1])});i._ondirectionchange=function(o){r=o==="next"?t._ascending:t._descending,n.sort(r)};var a=0;return i._addAlgorithm(function(o,s,u){for(var l=o.key;r(l,n[a])>0;)if(++a,a===n.length)return s(u),!1;return r(l,n[a])===0?!0:(s(function(){o.continue(n[a])}),!1)}),i},e.prototype.notEqual=function(t){return this.inAnyRange([[Mn,t],[t,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},e.prototype.noneOf=function(){var t=ye.apply(Ge,arguments);if(t.length===0)return new this.Collection(this);try{t.sort(this._ascending)}catch{return J(this,de)}var n=t.reduce(function(r,i){return r?r.concat([[r[r.length-1][1],i]]):[[Mn,i]]},null);return n.push([t[t.length-1],this.db._maxKey]),this.inAnyRange(n,{includeLowers:!1,includeUppers:!1})},e.prototype.inAnyRange=function(t,n){var r=this,i=this._cmp,a=this._ascending,o=this._descending,s=this._min,u=this._max;if(t.length===0)return We(this);if(!t.every(function(m){return m[0]!==void 0&&m[1]!==void 0&&a(m[0],m[1])<=0}))return J(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",P.InvalidArgument);var l=!n||n.includeLowers!==!1,c=n&&n.includeUppers===!0;function f(m,x){for(var C=0,A=m.length;C<A;++C){var k=m[C];if(i(x[0],k[1])<0&&i(x[1],k[0])>0){k[0]=s(k[0],x[0]),k[1]=u(k[1],x[1]);break}}return C===A&&m.push(x),m}var h=a;function y(m,x){return h(m[0],x[0])}var p;try{p=t.reduce(f,[]),p.sort(y)}catch{return J(this,de)}var d=0,v=c?function(m){return a(m,p[d][1])>0}:function(m){return a(m,p[d][1])>=0},g=l?function(m){return o(m,p[d][0])>0}:function(m){return o(m,p[d][0])>=0};function _(m){return!v(m)&&!g(m)}var b=v,w=new this.Collection(this,function(){return Ee(p[0][0],p[p.length-1][1],!l,!c)});return w._ondirectionchange=function(m){m==="next"?(b=v,h=a):(b=g,h=o),p.sort(y)},w._addAlgorithm(function(m,x,C){for(var A=m.key;b(A);)if(++d,d===p.length)return x(C),!1;return _(A)?!0:(r._cmp(A,p[d][1])===0||r._cmp(A,p[d][0])===0||x(function(){h===a?m.continue(p[d][0]):m.continue(p[d][1])}),!1)}),w},e.prototype.startsWithAnyOf=function(){var t=ye.apply(Ge,arguments);return t.every(function(n){return typeof n=="string"})?t.length===0?We(this):this.inAnyRange(t.map(function(n){return[n,n+$e]})):J(this,"startsWithAnyOf() only works with strings")},e}();function lo(e){return Tt(bi.prototype,function(n,r,i){this.db=e,this._ctx={table:n,index:r===":id"?null:r,or:i};var a=e._deps.indexedDB;if(!a)throw new P.MissingAPI;this._cmp=this._ascending=a.cmp.bind(a),this._descending=function(o,s){return a.cmp(s,o)},this._max=function(o,s){return a.cmp(o,s)>0?o:s},this._min=function(o,s){return a.cmp(o,s)<0?o:s},this._IDBKeyRange=e._deps.IDBKeyRange})}function ce(e){return F(function(t){return yt(t),e(t.target.error),!1})}function yt(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}var mt="storagemutated",Ce="x-storagemutated-1",Oe=Pt(null,mt),co=function(){function e(){}return e.prototype._lock=function(){return st(!S.global),++this._reculock,this._reculock===1&&!S.global&&(S.lockOwnerFor=this),this},e.prototype._unlock=function(){if(st(!S.global),--this._reculock===0)for(S.global||(S.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var t=this._blockedFuncs.shift();try{at(t[1],t[0])}catch{}}return this},e.prototype._locked=function(){return this._reculock&&S.lockOwnerFor!==this},e.prototype.create=function(t){var n=this;if(!this.mode)return this;var r=this.db.idbdb,i=this.db._state.dbOpenError;if(st(!this.idbtrans),!t&&!r)switch(i&&i.name){case"DatabaseClosedError":throw new P.DatabaseClosed(i);case"MissingAPIError":throw new P.MissingAPI(i.message,i);default:throw new P.OpenFailed(i)}if(!this.active)throw new P.TransactionInactive;return st(this._completion._state===null),t=this.idbtrans=t||(this.db.core?this.db.core.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}):r.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})),t.onerror=F(function(a){yt(a),n._reject(t.error)}),t.onabort=F(function(a){yt(a),n.active&&n._reject(new P.Abort(t.error)),n.active=!1,n.on("abort").fire(a)}),t.oncomplete=F(function(){n.active=!1,n._resolve(),"mutatedParts"in t&&Oe.storagemutated.fire(t.mutatedParts)}),this},e.prototype._promise=function(t,n,r){var i=this;if(t==="readwrite"&&this.mode!=="readwrite")return H(new P.ReadOnly("Transaction is readonly"));if(!this.active)return H(new P.TransactionInactive);if(this._locked())return new E(function(o,s){i._blockedFuncs.push([function(){i._promise(t,n,r).then(o,s)},S])});if(r)return Pe(function(){var o=new E(function(s,u){i._lock();var l=n(s,u,i);l&&l.then&&l.then(s,u)});return o.finally(function(){return i._unlock()}),o._lib=!0,o});var a=new E(function(o,s){var u=n(o,s,i);u&&u.then&&u.then(o,s)});return a._lib=!0,a},e.prototype._root=function(){return this.parent?this.parent._root():this},e.prototype.waitFor=function(t){var n=this._root(),r=E.resolve(t);if(n._waitingFor)n._waitingFor=n._waitingFor.then(function(){return r});else{n._waitingFor=r,n._waitingQueue=[];var i=n.idbtrans.objectStore(n.storeNames[0]);(function o(){for(++n._spinCount;n._waitingQueue.length;)n._waitingQueue.shift()();n._waitingFor&&(i.get(-1/0).onsuccess=o)})()}var a=n._waitingFor;return new E(function(o,s){r.then(function(u){return n._waitingQueue.push(F(o.bind(null,u)))},function(u){return n._waitingQueue.push(F(s.bind(null,u)))}).finally(function(){n._waitingFor===a&&(n._waitingFor=null)})})},e.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new P.Abort))},e.prototype.table=function(t){var n=this._memoizedTables||(this._memoizedTables={});if(Z(n,t))return n[t];var r=this.schema[t];if(!r)throw new P.NotFound("Table "+t+" not part of transaction");var i=new this.db.Table(t,r,this);return i.core=this.db.core.table(t),n[t]=i,i},e}();function fo(e){return Tt(co.prototype,function(n,r,i,a,o){var s=this;this.db=e,this.mode=n,this.storeNames=r,this.schema=i,this.chromeTransactionDurability=a,this.idbtrans=null,this.on=Pt(this,"complete","error","abort"),this.parent=o||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new E(function(u,l){s._resolve=u,s._reject=l}),this._completion.then(function(){s.active=!1,s.on.complete.fire()},function(u){var l=s.active;return s.active=!1,s.on.error.fire(u),s.parent?s.parent._reject(u):l&&s.idbtrans&&s.idbtrans.abort(),H(u)})})}function Fn(e,t,n,r,i,a,o){return{name:e,keyPath:t,unique:n,multi:r,auto:i,compound:a,src:(n&&!o?"&":"")+(r?"*":"")+(i?"++":"")+wi(t)}}function wi(e){return typeof e=="string"?e:e?"["+[].join.call(e,"+")+"]":""}function _i(e,t,n){return{name:e,primKey:t,indexes:n,mappedClass:null,idxByName:Jr(n,function(r){return[r.name,r]})}}function ho(e){return e.length===1?e[0]:e}var gt=function(e){try{return e.only([[]]),gt=function(){return[[]]},[[]]}catch{return gt=function(){return $e},$e}};function Nn(e){return e==null?function(){}:typeof e=="string"?po(e):function(t){return be(t,e)}}function po(e){var t=e.split(".");return t.length===1?function(n){return n[e]}:function(n){return be(n,e)}}function Rr(e){return[].slice.call(e)}var vo=0;function ht(e){return e==null?":id":typeof e=="string"?e:"["+e.join("+")+"]"}function yo(e,t,n){function r(f,h){var y=Rr(f.objectStoreNames);return{schema:{name:f.name,tables:y.map(function(p){return h.objectStore(p)}).map(function(p){var d=p.keyPath,v=p.autoIncrement,g=G(d),_=d==null,b={},w={name:p.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:_,compound:g,keyPath:d,autoIncrement:v,unique:!0,extractKey:Nn(d)},indexes:Rr(p.indexNames).map(function(m){return p.index(m)}).map(function(m){var x=m.name,C=m.unique,A=m.multiEntry,k=m.keyPath,T=G(k),R={name:x,compound:T,keyPath:k,unique:C,multiEntry:A,extractKey:Nn(k)};return b[ht(k)]=R,R}),getIndexByKeyPath:function(m){return b[ht(m)]}};return b[":id"]=w.primaryKey,d!=null&&(b[ht(d)]=w.primaryKey),w})},hasGetAll:y.length>0&&"getAll"in h.objectStore(y[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}function i(f){if(f.type===3)return null;if(f.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var h=f.lower,y=f.upper,p=f.lowerOpen,d=f.upperOpen,v=h===void 0?y===void 0?null:t.upperBound(y,!!d):y===void 0?t.lowerBound(h,!!p):t.bound(h,y,!!p,!!d);return v}function a(f){var h=f.name;function y(v){var g=v.trans,_=v.type,b=v.keys,w=v.values,m=v.range;return new Promise(function(x,C){x=F(x);var A=g.objectStore(h),k=A.keyPath==null,T=_==="put"||_==="add";if(!T&&_!=="delete"&&_!=="deleteRange")throw new Error("Invalid operation type: "+_);var R=(b||w||{length:1}).length;if(b&&w&&b.length!==w.length)throw new Error("Given keys array must have same length as given values array.");if(R===0)return x({numFailures:0,failures:{},results:[],lastResult:void 0});var I,K=[],z=[],O=0,ee=function(le){++O,yt(le)};if(_==="deleteRange"){if(m.type===4)return x({numFailures:O,failures:z,results:[],lastResult:void 0});m.type===3?K.push(I=A.clear()):K.push(I=A.delete(i(m)))}else{var ie=T?k?[w,b]:[w,null]:[b,null],xe=ie[0],ue=ie[1];if(T)for(var te=0;te<R;++te)K.push(I=ue&&ue[te]!==void 0?A[_](xe[te],ue[te]):A[_](xe[te])),I.onerror=ee;else for(var te=0;te<R;++te)K.push(I=A[_](xe[te])),I.onerror=ee}var Ae=function(le){var ot=le.target.result;K.forEach(function(ae,Ot){return ae.error!=null&&(z[Ot]=ae.error)}),x({numFailures:O,failures:z,results:_==="delete"?b:K.map(function(ae){return ae.result}),lastResult:ot})};I.onerror=function(le){ee(le),Ae(le)},I.onsuccess=Ae})}function p(v){var g=v.trans,_=v.values,b=v.query,w=v.reverse,m=v.unique;return new Promise(function(x,C){x=F(x);var A=b.index,k=b.range,T=g.objectStore(h),R=A.isPrimaryKey?T:T.index(A.name),I=w?m?"prevunique":"prev":m?"nextunique":"next",K=_||!("openKeyCursor"in R)?R.openCursor(i(k),I):R.openKeyCursor(i(k),I);K.onerror=ce(C),K.onsuccess=F(function(z){var O=K.result;if(!O){x(null);return}O.___id=++vo,O.done=!1;var ee=O.continue.bind(O),ie=O.continuePrimaryKey;ie&&(ie=ie.bind(O));var xe=O.advance.bind(O),ue=function(){throw new Error("Cursor not started")},te=function(){throw new Error("Cursor not stopped")};O.trans=g,O.stop=O.continue=O.continuePrimaryKey=O.advance=ue,O.fail=F(C),O.next=function(){var Ae=this,le=1;return this.start(function(){return le--?Ae.continue():Ae.stop()}).then(function(){return Ae})},O.start=function(Ae){var le=new Promise(function(ae,Ot){ae=F(ae),K.onerror=ce(Ot),O.fail=Ot,O.stop=function(Bi){O.stop=O.continue=O.continuePrimaryKey=O.advance=te,ae(Bi)}}),ot=function(){if(K.result)try{Ae()}catch(ae){O.fail(ae)}else O.done=!0,O.start=function(){throw new Error("Cursor behind last entry")},O.stop()};return K.onsuccess=F(function(ae){K.onsuccess=ot,ot()}),O.continue=ee,O.continuePrimaryKey=ie,O.advance=xe,ot(),le},x(O)},C)})}function d(v){return function(g){return new Promise(function(_,b){_=F(_);var w=g.trans,m=g.values,x=g.limit,C=g.query,A=x===1/0?void 0:x,k=C.index,T=C.range,R=w.objectStore(h),I=k.isPrimaryKey?R:R.index(k.name),K=i(T);if(x===0)return _({result:[]});if(v){var z=m?I.getAll(K,A):I.getAllKeys(K,A);z.onsuccess=function(xe){return _({result:xe.target.result})},z.onerror=ce(b)}else{var O=0,ee=m||!("openKeyCursor"in I)?I.openCursor(K):I.openKeyCursor(K),ie=[];ee.onsuccess=function(xe){var ue=ee.result;if(!ue)return _({result:ie});if(ie.push(m?ue.value:ue.primaryKey),++O===x)return _({result:ie});ue.continue()},ee.onerror=ce(b)}})}}return{name:h,schema:f,mutate:y,getMany:function(v){var g=v.trans,_=v.keys;return new Promise(function(b,w){b=F(b);for(var m=g.objectStore(h),x=_.length,C=new Array(x),A=0,k=0,T,R=function(O){var ee=O.target;(C[ee._pos]=ee.result)!=null,++k===A&&b(C)},I=ce(w),K=0;K<x;++K){var z=_[K];z!=null&&(T=m.get(_[K]),T._pos=K,T.onsuccess=R,T.onerror=I,++A)}A===0&&b(C)})},get:function(v){var g=v.trans,_=v.key;return new Promise(function(b,w){b=F(b);var m=g.objectStore(h),x=m.get(_);x.onsuccess=function(C){return b(C.target.result)},x.onerror=ce(w)})},query:d(u),openCursor:p,count:function(v){var g=v.query,_=v.trans,b=g.index,w=g.range;return new Promise(function(m,x){var C=_.objectStore(h),A=b.isPrimaryKey?C:C.index(b.name),k=i(w),T=k?A.count(k):A.count();T.onsuccess=F(function(R){return m(R.target.result)}),T.onerror=ce(x)})}}}var o=r(e,n),s=o.schema,u=o.hasGetAll,l=s.tables.map(function(f){return a(f)}),c={};return l.forEach(function(f){return c[f.name]=f}),{stack:"dbcore",transaction:e.transaction.bind(e),table:function(f){var h=c[f];if(!h)throw new Error("Table '"+f+"' not found");return c[f]},MIN_KEY:-1/0,MAX_KEY:gt(t),schema:s}}function mo(e,t){return t.reduce(function(n,r){var i=r.create;return D(D({},n),i(n))},e)}function go(e,t,n,r){var i=n.IDBKeyRange;n.indexedDB;var a=mo(yo(t,i,r),e.dbcore);return{dbcore:a}}function ur(e,t){var n=e._novip,r=t.db,i=go(n._middlewares,r,n._deps,t);n.core=i.dbcore,n.tables.forEach(function(a){var o=a.name;n.core.schema.tables.some(function(s){return s.name===o})&&(a.core=n.core.table(o),n[o]instanceof n.Table&&(n[o].core=a.core))})}function nn(e,t,n,r){var i=e._novip;n.forEach(function(a){var o=r[a];t.forEach(function(s){var u=Zn(s,a);(!u||"value"in u&&u.value===void 0)&&(s===i.Transaction.prototype||s instanceof i.Transaction?we(s,a,{get:function(){return this.table(a)},set:function(l){Xr(this,a,{value:l,writable:!0,configurable:!0,enumerable:!0})}}):s[a]=new i.Table(a,o))})})}function Ln(e,t){var n=e._novip;t.forEach(function(r){for(var i in r)r[i]instanceof n.Table&&delete r[i]})}function bo(e,t){return e._cfg.version-t._cfg.version}function wo(e,t,n,r){var i=e._dbSchema,a=e._createTransaction("readwrite",e._storeNames,i);a.create(n),a._completion.catch(r);var o=a._reject.bind(a),s=S.transless||S;Pe(function(){S.trans=a,S.transless=s,t===0?(L(i).forEach(function(u){lr(n,u,i[u].primKey,i[u].indexes)}),ur(e,n),E.follow(function(){return e.on.populate.fire(a)}).catch(o)):_o(e,t,a,n).catch(o)})}function _o(e,t,n,r){var i=e._novip,a=[],o=i._versions,s=i._dbSchema=cr(i,i.idbdb,r),u=!1,l=o.filter(function(f){return f._cfg.version>=t});l.forEach(function(f){a.push(function(){var h=s,y=f._cfg.dbschema;Hn(i,h,r),Hn(i,y,r),s=i._dbSchema=y;var p=xi(h,y);p.add.forEach(function(w){lr(r,w[0],w[1].primKey,w[1].indexes)}),p.change.forEach(function(w){if(w.recreate)throw new P.Upgrade("Not yet support for changing primary key");var m=r.objectStore(w.name);w.add.forEach(function(x){return jn(m,x)}),w.change.forEach(function(x){m.deleteIndex(x.name),jn(m,x)}),w.del.forEach(function(x){return m.deleteIndex(x)})});var d=f._cfg.contentUpgrade;if(d&&f._cfg.version>t){ur(i,r),n._memoizedTables={},u=!0;var v=Zr(y);p.del.forEach(function(w){v[w]=h[w]}),Ln(i,[i.Transaction.prototype]),nn(i,[i.Transaction.prototype],L(v),v),n.schema=v;var g=er(d);g&&it();var _,b=E.follow(function(){if(_=d(n),_&&g){var w=_e.bind(null,null);_.then(w,w)}});return _&&typeof _.then=="function"?E.resolve(_):b.then(function(){return _})}}),a.push(function(h){if(!u||!Xa){var y=f._cfg.dbschema;Ao(y,h)}Ln(i,[i.Transaction.prototype]),nn(i,[i.Transaction.prototype],i._storeNames,i._dbSchema),n.schema=i._dbSchema})});function c(){return a.length?E.resolve(a.shift()(n.idbtrans)).then(c):E.resolve()}return c().then(function(){xo(s,r)})}function xi(e,t){var n={del:[],add:[],change:[]},r;for(r in e)t[r]||n.del.push(r);for(r in t){var i=e[r],a=t[r];if(!i)n.add.push([r,a]);else{var o={name:r,def:a,recreate:!1,del:[],add:[],change:[]};if(""+(i.primKey.keyPath||"")!=""+(a.primKey.keyPath||"")||i.primKey.auto!==a.primKey.auto&&!cn)o.recreate=!0,n.change.push(o);else{var s=i.idxByName,u=a.idxByName,l=void 0;for(l in s)u[l]||o.del.push(l);for(l in u){var c=s[l],f=u[l];c?c.src!==f.src&&o.change.push(f):o.add.push(f)}(o.del.length>0||o.add.length>0||o.change.length>0)&&n.change.push(o)}}}return n}function lr(e,t,n,r){var i=e.db.createObjectStore(t,n.keyPath?{keyPath:n.keyPath,autoIncrement:n.auto}:{autoIncrement:n.auto});return r.forEach(function(a){return jn(i,a)}),i}function xo(e,t){L(e).forEach(function(n){t.db.objectStoreNames.contains(n)||lr(t,n,e[n].primKey,e[n].indexes)})}function Ao(e,t){[].slice.call(t.db.objectStoreNames).forEach(function(n){return e[n]==null&&t.db.deleteObjectStore(n)})}function jn(e,t){e.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function cr(e,t,n){var r={},i=un(t.objectStoreNames,0);return i.forEach(function(a){for(var o=n.objectStore(a),s=o.keyPath,u=Fn(wi(s),s||"",!1,!1,!!o.autoIncrement,s&&typeof s!="string",!0),l=[],c=0;c<o.indexNames.length;++c){var f=o.index(o.indexNames[c]);s=f.keyPath;var h=Fn(f.name,s,!!f.unique,!!f.multiEntry,!1,s&&typeof s!="string",!1);l.push(h)}r[a]=_i(a,u,l)}),r}function Eo(e,t,n){var r=e._novip;r.verno=t.version/10;var i=r._dbSchema=cr(r,t,n);r._storeNames=un(t.objectStoreNames,0),nn(r,[r._allTables],L(i),i)}function So(e,t){var n=cr(e,e.idbdb,t),r=xi(n,e._dbSchema);return!(r.add.length||r.change.some(function(i){return i.add.length||i.change.length}))}function Hn(e,t,n){for(var r=e._novip,i=n.db.objectStoreNames,a=0;a<i.length;++a){var o=i[a],s=n.objectStore(o);r._hasGetAll="getAll"in s;for(var u=0;u<s.indexNames.length;++u){var l=s.indexNames[u],c=s.index(l).keyPath,f=typeof c=="string"?c:"["+un(c).join("+")+"]";if(t[o]){var h=t[o].idxByName[f];h&&(h.name=l,delete t[o].idxByName[f],t[o].idxByName[l]=h)}}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&M.WorkerGlobalScope&&M instanceof M.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(r._hasGetAll=!1)}function Co(e){return e.split(",").map(function(t,n){t=t.trim();var r=t.replace(/([&*]|\+\+)/g,""),i=/^\[/.test(r)?r.match(/^\[(.*)\]$/)[1].split("+"):r;return Fn(r,i||null,/\&/.test(t),/\*/.test(t),/\+\+/.test(t),G(i),n===0)})}var ko=function(){function e(){}return e.prototype._parseStoresSpec=function(t,n){L(t).forEach(function(r){if(t[r]!==null){var i=Co(t[r]),a=i.shift();if(a.multi)throw new P.Schema("Primary key cannot be multi-valued");i.forEach(function(o){if(o.auto)throw new P.Schema("Only primary key can be marked as autoIncrement (++)");if(!o.keyPath)throw new P.Schema("Index must have a name and cannot be an empty string")}),n[r]=_i(r,a,i)}})},e.prototype.stores=function(t){var n=this.db;this._cfg.storesSource=this._cfg.storesSource?Q(this._cfg.storesSource,t):t;var r=n._versions,i={},a={};return r.forEach(function(o){Q(i,o._cfg.storesSource),a=o._cfg.dbschema={},o._parseStoresSpec(i,a)}),n._dbSchema=a,Ln(n,[n._allTables,n,n.Transaction.prototype]),nn(n,[n._allTables,n,n.Transaction.prototype,this._cfg.tables],L(a),a),n._storeNames=L(a),this},e.prototype.upgrade=function(t){return this._cfg.contentUpgrade=rr(this._cfg.contentUpgrade||B,t),this},e}();function Po(e){return Tt(ko.prototype,function(n){this.db=e,this._cfg={version:n,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})}function fr(e,t){var n=e._dbNamesDB;return n||(n=e._dbNamesDB=new vr(fn,{addons:[],indexedDB:e,IDBKeyRange:t}),n.version(1).stores({dbnames:"name"})),n.table("dbnames")}function hr(e){return e&&typeof e.databases=="function"}function To(e){var t=e.indexedDB,n=e.IDBKeyRange;return hr(t)?Promise.resolve(t.databases()).then(function(r){return r.map(function(i){return i.name}).filter(function(i){return i!==fn})}):fr(t,n).toCollection().primaryKeys()}function Oo(e,t){var n=e.indexedDB,r=e.IDBKeyRange;!hr(n)&&t!==fn&&fr(n,r).put({name:t}).catch(B)}function Do(e,t){var n=e.indexedDB,r=e.IDBKeyRange;!hr(n)&&t!==fn&&fr(n,r).delete(t).catch(B)}function Vn(e){return Pe(function(){return S.letThrough=!0,e()})}function Ko(){var e=!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent);if(!e||!indexedDB.databases)return Promise.resolve();var t;return new Promise(function(n){var r=function(){return indexedDB.databases().finally(n)};t=setInterval(r,100),r()}).finally(function(){return clearInterval(t)})}function Ro(e){var t=e._state,n=e._deps.indexedDB;if(t.isBeingOpened||e.idbdb)return t.dbReadyPromise.then(function(){return t.dbOpenError?H(t.dbOpenError):e});he&&(t.openCanceller._stackHolder=Ve()),t.isBeingOpened=!0,t.dbOpenError=null,t.openComplete=!1;var r=t.openCanceller;function i(){if(t.openCanceller!==r)throw new P.DatabaseClosed("db.open() was cancelled")}var a=t.dbReadyResolve,o=null,s=!1;return E.race([r,(typeof navigator>"u"?E.resolve():Ko()).then(function(){return new E(function(u,l){if(i(),!n)throw new P.MissingAPI;var c=e.name,f=t.autoSchema?n.open(c):n.open(c,Math.round(e.verno*10));if(!f)throw new P.MissingAPI;f.onerror=ce(l),f.onblocked=F(e._fireOnBlocked),f.onupgradeneeded=F(function(h){if(o=f.transaction,t.autoSchema&&!e._options.allowEmptyDB){f.onerror=yt,o.abort(),f.result.close();var y=n.deleteDatabase(c);y.onsuccess=y.onerror=F(function(){l(new P.NoSuchDatabase("Database "+c+" doesnt exist"))})}else{o.onerror=ce(l);var p=h.oldVersion>Math.pow(2,62)?0:h.oldVersion;s=p<1,e._novip.idbdb=f.result,wo(e,p/10,o,l)}},l),f.onsuccess=F(function(){o=null;var h=e._novip.idbdb=f.result,y=un(h.objectStoreNames);if(y.length>0)try{var p=h.transaction(ho(y),"readonly");t.autoSchema?Eo(e,h,p):(Hn(e,e._dbSchema,p),So(e,p)||console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Some queries may fail.")),ur(e,p)}catch{}ft.push(e),h.onversionchange=F(function(d){t.vcFired=!0,e.on("versionchange").fire(d)}),h.onclose=F(function(d){e.on("close").fire(d)}),s&&Oo(e._deps,c),u()},l)})})]).then(function(){return i(),t.onReadyBeingFired=[],E.resolve(Vn(function(){return e.on.ready.fire(e.vip)})).then(function u(){if(t.onReadyBeingFired.length>0){var l=t.onReadyBeingFired.reduce(rr,B);return t.onReadyBeingFired=[],E.resolve(Vn(function(){return l(e.vip)})).then(u)}})}).finally(function(){t.onReadyBeingFired=null,t.isBeingOpened=!1}).then(function(){return e}).catch(function(u){t.dbOpenError=u;try{o&&o.abort()}catch{}return r===t.openCanceller&&e._close(),H(u)}).finally(function(){t.openComplete=!0,a()})}function zn(e){var t=function(o){return e.next(o)},n=function(o){return e.throw(o)},r=a(t),i=a(n);function a(o){return function(s){var u=o(s),l=u.value;return u.done?l:!l||typeof l.then!="function"?G(l)?Promise.all(l).then(r,i):r(l):l.then(r,i)}}return a(t)()}function Io(e,t,n){var r=arguments.length;if(r<2)throw new P.InvalidArgument("Too few arguments");for(var i=new Array(r-1);--r;)i[r-1]=arguments[r];n=i.pop();var a=ei(i);return[e,a,n]}function Ai(e,t,n,r,i){return E.resolve().then(function(){var a=S.transless||S,o=e._createTransaction(t,n,e._dbSchema,r),s={trans:o,transless:a};if(r)o.idbtrans=r.idbtrans;else try{o.create(),e._state.PR1398_maxLoop=3}catch(f){return f.name===nr.InvalidState&&e.isOpen()&&--e._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),e._close(),e.open().then(function(){return Ai(e,t,n,null,i)})):H(f)}var u=er(i);u&&it();var l,c=E.follow(function(){if(l=i.call(o,o),l)if(u){var f=_e.bind(null,null);l.then(f,f)}else typeof l.next=="function"&&typeof l.throw=="function"&&(l=zn(l))},s);return(l&&typeof l.then=="function"?E.resolve(l).then(function(f){return o.active?f:H(new P.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):c.then(function(){return l})).then(function(f){return r&&o._resolve(),o._completion.then(function(){return f})}).catch(function(f){return o._reject(f),H(f)})})}function $t(e,t,n){for(var r=G(e)?e.slice():[e],i=0;i<n;++i)r.push(t);return r}function Bo(e){return D(D({},e),{table:function(t){var n=e.table(t),r=n.schema,i={},a=[];function o(d,v,g){var _=ht(d),b=i[_]=i[_]||[],w=d==null?0:typeof d=="string"?1:d.length,m=v>0,x=D(D({},g),{isVirtual:m,keyTail:v,keyLength:w,extractKey:Nn(d),unique:!m&&g.unique});if(b.push(x),x.isPrimaryKey||a.push(x),w>1){var C=w===2?d[0]:d.slice(0,w-1);o(C,v+1,g)}return b.sort(function(A,k){return A.keyTail-k.keyTail}),x}var s=o(r.primaryKey.keyPath,0,r.primaryKey);i[":id"]=[s];for(var u=0,l=r.indexes;u<l.length;u++){var c=l[u];o(c.keyPath,0,c)}function f(d){var v=i[ht(d)];return v&&v[0]}function h(d,v){return{type:d.type===1?2:d.type,lower:$t(d.lower,d.lowerOpen?e.MAX_KEY:e.MIN_KEY,v),lowerOpen:!0,upper:$t(d.upper,d.upperOpen?e.MIN_KEY:e.MAX_KEY,v),upperOpen:!0}}function y(d){var v=d.query.index;return v.isVirtual?D(D({},d),{query:{index:v,range:h(d.query.range,v.keyTail)}}):d}var p=D(D({},n),{schema:D(D({},r),{primaryKey:s,indexes:a,getIndexByKeyPath:f}),count:function(d){return n.count(y(d))},query:function(d){return n.query(y(d))},openCursor:function(d){var v=d.query.index,g=v.keyTail,_=v.isVirtual,b=v.keyLength;if(!_)return n.openCursor(d);function w(m){function x(A){A!=null?m.continue($t(A,d.reverse?e.MAX_KEY:e.MIN_KEY,g)):d.unique?m.continue(m.key.slice(0,b).concat(d.reverse?e.MIN_KEY:e.MAX_KEY,g)):m.continue()}var C=Object.create(m,{continue:{value:x},continuePrimaryKey:{value:function(A,k){m.continuePrimaryKey($t(A,e.MAX_KEY,g),k)}},primaryKey:{get:function(){return m.primaryKey}},key:{get:function(){var A=m.key;return b===1?A[0]:A.slice(0,b)}},value:{get:function(){return m.value}}});return C}return n.openCursor(y(d)).then(function(m){return m&&w(m)})}});return p}})}var $o={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:Bo};function dr(e,t,n,r){return n=n||{},r=r||"",L(e).forEach(function(i){if(!Z(t,i))n[r+i]=void 0;else{var a=e[i],o=t[i];if(typeof a=="object"&&typeof o=="object"&&a&&o){var s=Sn(a),u=Sn(o);s!==u?n[r+i]=t[i]:s==="Object"?dr(a,o,n,r+i+"."):a!==o&&(n[r+i]=t[i])}else a!==o&&(n[r+i]=t[i])}}),L(t).forEach(function(i){Z(e,i)||(n[r+i]=t[i])}),n}function Mo(e,t){return t.type==="delete"?t.keys:t.keys||t.values.map(e.extractKey)}var Fo={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(e){return D(D({},e),{table:function(t){var n=e.table(t),r=n.schema.primaryKey,i=D(D({},n),{mutate:function(a){var o=S.trans,s=o.table(t).hook,u=s.deleting,l=s.creating,c=s.updating;switch(a.type){case"add":if(l.fire===B)break;return o._promise("readwrite",function(){return f(a)},!0);case"put":if(l.fire===B&&c.fire===B)break;return o._promise("readwrite",function(){return f(a)},!0);case"delete":if(u.fire===B)break;return o._promise("readwrite",function(){return f(a)},!0);case"deleteRange":if(u.fire===B)break;return o._promise("readwrite",function(){return h(a)},!0)}return n.mutate(a);function f(p){var d=S.trans,v=p.keys||Mo(r,p);if(!v)throw new Error("Keys missing");return p=p.type==="add"||p.type==="put"?D(D({},p),{keys:v}):D({},p),p.type!=="delete"&&(p.values=An([],p.values,!0)),p.keys&&(p.keys=An([],p.keys,!0)),No(n,p,v).then(function(g){var _=v.map(function(b,w){var m=g[w],x={onerror:null,onsuccess:null};if(p.type==="delete")u.fire.call(x,b,m,d);else if(p.type==="add"||m===void 0){var C=l.fire.call(x,b,p.values[w],d);b==null&&C!=null&&(b=C,p.keys[w]=b,r.outbound||oe(p.values[w],r.keyPath,b))}else{var A=dr(m,p.values[w]),k=c.fire.call(x,A,b,m,d);if(k){var T=p.values[w];Object.keys(k).forEach(function(R){Z(T,R)?T[R]=k[R]:oe(T,R,k[R])})}}return x});return n.mutate(p).then(function(b){for(var w=b.failures,m=b.results,x=b.numFailures,C=b.lastResult,A=0;A<v.length;++A){var k=m?m[A]:v[A],T=_[A];k==null?T.onerror&&T.onerror(w[A]):T.onsuccess&&T.onsuccess(p.type==="put"&&g[A]?p.values[A]:k)}return{failures:w,results:m,numFailures:x,lastResult:C}}).catch(function(b){return _.forEach(function(w){return w.onerror&&w.onerror(b)}),Promise.reject(b)})})}function h(p){return y(p.trans,p.range,1e4)}function y(p,d,v){return n.query({trans:p,values:!1,query:{index:r,range:d},limit:v}).then(function(g){var _=g.result;return f({type:"delete",keys:_,trans:p}).then(function(b){return b.numFailures>0?Promise.reject(b.failures[0]):_.length<v?{failures:[],numFailures:0,lastResult:void 0}:y(p,D(D({},d),{lower:_[_.length-1],lowerOpen:!0}),v)})})}}});return i}})}};function No(e,t,n){return t.type==="add"?Promise.resolve([]):e.getMany({trans:t.trans,keys:n,cache:"immutable"})}function Ei(e,t,n){try{if(!t||t.keys.length<e.length)return null;for(var r=[],i=0,a=0;i<t.keys.length&&a<e.length;++i)X(t.keys[i],e[a])===0&&(r.push(n?Et(t.values[i]):t.values[i]),++a);return r.length===e.length?r:null}catch{return null}}var Lo={stack:"dbcore",level:-1,create:function(e){return{table:function(t){var n=e.table(t);return D(D({},n),{getMany:function(r){if(!r.cache)return n.getMany(r);var i=Ei(r.keys,r.trans._cache,r.cache==="clone");return i?E.resolve(i):n.getMany(r).then(function(a){return r.trans._cache={keys:r.keys,values:r.cache==="clone"?Et(a):a},a})},mutate:function(r){return r.type!=="add"&&(r.trans._cache=null),n.mutate(r)}})}}}},bn;function pr(e){return!("from"in e)}var pe=function(e,t){if(this)Q(this,arguments.length?{d:1,from:e,to:arguments.length>1?t:e}:{d:0});else{var n=new pe;return e&&"d"in e&&Q(n,e),n}};Ze(pe.prototype,(bn={add:function(e){return rn(this,e),this},addKey:function(e){return bt(this,e,e),this},addKeys:function(e){var t=this;return e.forEach(function(n){return bt(t,n,n)}),this}},bn[Cn]=function(){return Un(this)},bn));function bt(e,t,n){var r=X(t,n);if(!isNaN(r)){if(r>0)throw RangeError();if(pr(e))return Q(e,{from:t,to:n,d:1});var i=e.l,a=e.r;if(X(n,e.from)<0)return i?bt(i,t,n):e.l={from:t,to:n,d:1,l:null,r:null},Ir(e);if(X(t,e.to)>0)return a?bt(a,t,n):e.r={from:t,to:n,d:1,l:null,r:null},Ir(e);X(t,e.from)<0&&(e.from=t,e.l=null,e.d=a?a.d+1:1),X(n,e.to)>0&&(e.to=n,e.r=null,e.d=e.l?e.l.d+1:1);var o=!e.r;i&&!e.l&&rn(e,i),a&&o&&rn(e,a)}}function rn(e,t){function n(r,i){var a=i.from,o=i.to,s=i.l,u=i.r;bt(r,a,o),s&&n(r,s),u&&n(r,u)}pr(t)||n(e,t)}function jo(e,t){var n=Un(t),r=n.next();if(r.done)return!1;for(var i=r.value,a=Un(e),o=a.next(i.from),s=o.value;!r.done&&!o.done;){if(X(s.from,i.to)<=0&&X(s.to,i.from)>=0)return!0;X(i.from,s.from)<0?i=(r=n.next(s.from)).value:s=(o=a.next(i.from)).value}return!1}function Un(e){var t=pr(e)?null:{s:0,n:e};return{next:function(n){for(var r=arguments.length>0;t;)switch(t.s){case 0:if(t.s=1,r)for(;t.n.l&&X(n,t.n.from)<0;)t={up:t,n:t.n.l,s:1};else for(;t.n.l;)t={up:t,n:t.n.l,s:1};case 1:if(t.s=2,!r||X(n,t.n.to)<=0)return{value:t.n,done:!1};case 2:if(t.n.r){t.s=3,t={up:t,n:t.n.r,s:0};continue}case 3:t=t.up}return{done:!0}}}}function Ir(e){var t,n,r=(((t=e.r)===null||t===void 0?void 0:t.d)||0)-(((n=e.l)===null||n===void 0?void 0:n.d)||0),i=r>1?"r":r<-1?"l":"";if(i){var a=i==="r"?"l":"r",o=D({},e),s=e[i];e.from=s.from,e.to=s.to,e[i]=s[i],o[i]=s[a],e[a]=o,o.d=Br(o)}e.d=Br(e)}function Br(e){var t=e.r,n=e.l;return(t?n?Math.max(t.d,n.d):t.d:n?n.d:0)+1}var Ho={stack:"dbcore",level:0,create:function(e){var t=e.schema.name,n=new pe(e.MIN_KEY,e.MAX_KEY);return D(D({},e),{table:function(r){var i=e.table(r),a=i.schema,o=a.primaryKey,s=o.extractKey,u=o.outbound,l=D(D({},i),{mutate:function(h){var y=h.trans,p=y.mutatedParts||(y.mutatedParts={}),d=function(C){var A="idb://"+t+"/"+r+"/"+C;return p[A]||(p[A]=new pe)},v=d(""),g=d(":dels"),_=h.type,b=h.type==="deleteRange"?[h.range]:h.type==="delete"?[h.keys]:h.values.length<50?[[],h.values]:[],w=b[0],m=b[1],x=h.trans._cache;return i.mutate(h).then(function(C){if(G(w)){_!=="delete"&&(w=C.results),v.addKeys(w);var A=Ei(w,x);!A&&_!=="add"&&g.addKeys(w),(A||m)&&Vo(d,a,A,m)}else if(w){var k={from:w.lower,to:w.upper};g.add(k),v.add(k)}else v.add(n),g.add(n),a.indexes.forEach(function(T){return d(T.name).add(n)});return C})}}),c=function(h){var y,p,d=h.query,v=d.index,g=d.range;return[v,new pe((y=g.lower)!==null&&y!==void 0?y:e.MIN_KEY,(p=g.upper)!==null&&p!==void 0?p:e.MAX_KEY)]},f={get:function(h){return[o,new pe(h.key)]},getMany:function(h){return[o,new pe().addKeys(h.keys)]},count:c,query:c,openCursor:c};return L(f).forEach(function(h){l[h]=function(y){var p=S.subscr;if(p){var d=function(x){var C="idb://"+t+"/"+r+"/"+x;return p[C]||(p[C]=new pe)},v=d(""),g=d(":dels"),_=f[h](y),b=_[0],w=_[1];if(d(b.name||"").add(w),!b.isPrimaryKey)if(h==="count")g.add(n);else{var m=h==="query"&&u&&y.values&&i.query(D(D({},y),{values:!1}));return i[h].apply(this,arguments).then(function(x){if(h==="query"){if(u&&y.values)return m.then(function(T){var R=T.result;return v.addKeys(R),x});var C=y.values?x.result.map(s):x.result;y.values?v.addKeys(C):g.addKeys(C)}else if(h==="openCursor"){var A=x,k=y.values;return A&&Object.create(A,{key:{get:function(){return g.addKey(A.primaryKey),A.key}},primaryKey:{get:function(){var T=A.primaryKey;return g.addKey(T),T}},value:{get:function(){return k&&v.addKey(A.primaryKey),A.value}}})}return x})}}return i[h].apply(this,arguments)}}),l}})}};function Vo(e,t,n,r){function i(a){var o=e(a.name||"");function s(l){return l!=null?a.extractKey(l):null}var u=function(l){return a.multiEntry&&G(l)?l.forEach(function(c){return o.addKey(c)}):o.addKey(l)};(n||r).forEach(function(l,c){var f=n&&s(n[c]),h=r&&s(r[c]);X(f,h)!==0&&(f!=null&&u(f),h!=null&&u(h))})}t.indexes.forEach(i)}var vr=function(){function e(t,n){var r=this;this._middlewares={},this.verno=0;var i=e.dependencies;this._options=n=D({addons:e.addons,autoOpen:!0,indexedDB:i.indexedDB,IDBKeyRange:i.IDBKeyRange},n),this._deps={indexedDB:n.indexedDB,IDBKeyRange:n.IDBKeyRange};var a=n.addons;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var o={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:B,dbReadyPromise:null,cancelOpen:B,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3};o.dbReadyPromise=new E(function(s){o.dbReadyResolve=s}),o.openCanceller=new E(function(s,u){o.cancelOpen=u}),this._state=o,this.name=t,this.on=Pt(this,"populate","blocked","versionchange","close",{ready:[rr,B]}),this.on.ready.subscribe=Qr(this.on.ready.subscribe,function(s){return function(u,l){e.vip(function(){var c=r._state;if(c.openComplete)c.dbOpenError||E.resolve().then(u),l&&s(u);else if(c.onReadyBeingFired)c.onReadyBeingFired.push(u),l&&s(u);else{s(u);var f=r;l||s(function h(){f.on.ready.unsubscribe(u),f.on.ready.unsubscribe(h)})}})}}),this.Collection=ro(this),this.Table=Ja(this),this.Transaction=fo(this),this.Version=Po(this),this.WhereClause=lo(this),this.on("versionchange",function(s){s.newVersion>0?console.warn("Another connection wants to upgrade database '"+r.name+"'. Closing db now to resume the upgrade."):console.warn("Another connection wants to delete database '"+r.name+"'. Closing db now to resume the delete request."),r.close()}),this.on("blocked",function(s){!s.newVersion||s.newVersion<s.oldVersion?console.warn("Dexie.delete('"+r.name+"') was blocked"):console.warn("Upgrade '"+r.name+"' blocked by other connection holding version "+s.oldVersion/10)}),this._maxKey=gt(n.IDBKeyRange),this._createTransaction=function(s,u,l,c){return new r.Transaction(s,u,l,r._options.chromeTransactionDurability,c)},this._fireOnBlocked=function(s){r.on("blocked").fire(s),ft.filter(function(u){return u.name===r.name&&u!==r&&!u._state.vcFired}).map(function(u){return u.on("versionchange").fire(s)})},this.use($o),this.use(Fo),this.use(Ho),this.use(Lo),this.vip=Object.create(this,{_vip:{value:!0}}),a.forEach(function(s){return s(r)})}return e.prototype.version=function(t){if(isNaN(t)||t<.1)throw new P.Type("Given version is not a positive number");if(t=Math.round(t*10)/10,this.idbdb||this._state.isBeingOpened)throw new P.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,t);var n=this._versions,r=n.filter(function(i){return i._cfg.version===t})[0];return r||(r=new this.Version(t),n.push(r),n.sort(bo),r.stores({}),this._state.autoSchema=!1,r)},e.prototype._whenReady=function(t){var n=this;return this.idbdb&&(this._state.openComplete||S.letThrough||this._vip)?t():new E(function(r,i){if(n._state.openComplete)return i(new P.DatabaseClosed(n._state.dbOpenError));if(!n._state.isBeingOpened){if(!n._options.autoOpen){i(new P.DatabaseClosed);return}n.open().catch(B)}n._state.dbReadyPromise.then(r,i)}).then(t)},e.prototype.use=function(t){var n=t.stack,r=t.create,i=t.level,a=t.name;a&&this.unuse({stack:n,name:a});var o=this._middlewares[n]||(this._middlewares[n]=[]);return o.push({stack:n,create:r,level:i??10,name:a}),o.sort(function(s,u){return s.level-u.level}),this},e.prototype.unuse=function(t){var n=t.stack,r=t.name,i=t.create;return n&&this._middlewares[n]&&(this._middlewares[n]=this._middlewares[n].filter(function(a){return i?a.create!==i:r?a.name!==r:!1})),this},e.prototype.open=function(){return Ro(this)},e.prototype._close=function(){var t=this._state,n=ft.indexOf(this);if(n>=0&&ft.splice(n,1),this.idbdb){try{this.idbdb.close()}catch{}this._novip.idbdb=null}t.dbReadyPromise=new E(function(r){t.dbReadyResolve=r}),t.openCanceller=new E(function(r,i){t.cancelOpen=i})},e.prototype.close=function(){this._close();var t=this._state;this._options.autoOpen=!1,t.dbOpenError=new P.DatabaseClosed,t.isBeingOpened&&t.cancelOpen(t.dbOpenError)},e.prototype.delete=function(){var t=this,n=arguments.length>0,r=this._state;return new E(function(i,a){var o=function(){t.close();var s=t._deps.indexedDB.deleteDatabase(t.name);s.onsuccess=F(function(){Do(t._deps,t.name),i()}),s.onerror=ce(a),s.onblocked=t._fireOnBlocked};if(n)throw new P.InvalidArgument("Arguments not allowed in db.delete()");r.isBeingOpened?r.dbReadyPromise.then(o):o()})},e.prototype.backendDB=function(){return this.idbdb},e.prototype.isOpen=function(){return this.idbdb!==null},e.prototype.hasBeenClosed=function(){var t=this._state.dbOpenError;return t&&t.name==="DatabaseClosed"},e.prototype.hasFailed=function(){return this._state.dbOpenError!==null},e.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(e.prototype,"tables",{get:function(){var t=this;return L(this._allTables).map(function(n){return t._allTables[n]})},enumerable:!1,configurable:!0}),e.prototype.transaction=function(){var t=Io.apply(this,arguments);return this._transaction.apply(this,t)},e.prototype._transaction=function(t,n,r){var i=this,a=S.trans;(!a||a.db!==this||t.indexOf("!")!==-1)&&(a=null);var o=t.indexOf("?")!==-1;t=t.replace("!","").replace("?","");var s,u;try{if(u=n.map(function(c){var f=c instanceof i.Table?c.name:c;if(typeof f!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return f}),t=="r"||t===pn)s=pn;else if(t=="rw"||t==vn)s=vn;else throw new P.InvalidArgument("Invalid transaction mode: "+t);if(a){if(a.mode===pn&&s===vn)if(o)a=null;else throw new P.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");a&&u.forEach(function(c){if(a&&a.storeNames.indexOf(c)===-1)if(o)a=null;else throw new P.SubTransaction("Table "+c+" not included in parent transaction.")}),o&&a&&!a.active&&(a=null)}}catch(c){return a?a._promise(null,function(f,h){h(c)}):H(c)}var l=Ai.bind(null,this,s,u,a,r);return a?a._promise(s,l,"lock"):S.trans?at(S.transless,function(){return i._whenReady(l)}):this._whenReady(l)},e.prototype.table=function(t){if(!Z(this._allTables,t))throw new P.InvalidTable("Table "+t+" does not exist");return this._allTables[t]},e}(),zo=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",Uo=function(){function e(t){this._subscribe=t}return e.prototype.subscribe=function(t,n,r){return this._subscribe(!t||typeof t=="function"?{next:t,error:n,complete:r}:t)},e.prototype[zo]=function(){return this},e}();function Si(e,t){return L(t).forEach(function(n){var r=e[n]||(e[n]=new pe);rn(r,t[n])}),e}function Ci(e){return new Uo(function(t){var n=er(e);function r(y){n&&it();var p=function(){return Pe(e,{subscr:y,trans:null})},d=S.trans?at(S.transless,p):p();return n&&d.then(_e,_e),d}var i=!1,a={},o={},s={get closed(){return i},unsubscribe:function(){i=!0,Oe.storagemutated.unsubscribe(f)}};t.start&&t.start(s);var u=!1,l=!1;function c(){return L(o).some(function(y){return a[y]&&jo(a[y],o[y])})}var f=function(y){Si(a,y),c()&&h()},h=function(){if(!(u||i)){a={};var y={},p=r(y);l||(Oe(mt,f),l=!0),u=!0,Promise.resolve(p).then(function(d){u=!1,!i&&(c()?h():(a={},o=y,t.next&&t.next(d)))},function(d){u=!1,t.error&&t.error(d),s.unsubscribe()})}};return h(),s})}var Wn;try{Wn={indexedDB:M.indexedDB||M.mozIndexedDB||M.webkitIndexedDB||M.msIndexedDB,IDBKeyRange:M.IDBKeyRange||M.webkitIDBKeyRange}}catch{Wn={indexedDB:null,IDBKeyRange:null}}var Be=vr;Ze(Be,D(D({},ln),{delete:function(e){var t=new Be(e,{addons:[]});return t.delete()},exists:function(e){return new Be(e,{addons:[]}).open().then(function(t){return t.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(e){try{return To(Be.dependencies).then(e)}catch{return H(new P.MissingAPI)}},defineClass:function(){function e(t){Q(this,t)}return e},ignoreTransaction:function(e){return S.trans?at(S.transless,e):e()},vip:Vn,async:function(e){return function(){try{var t=zn(e.apply(this,arguments));return!t||typeof t.then!="function"?E.resolve(t):t}catch(n){return H(n)}}},spawn:function(e,t,n){try{var r=zn(e.apply(n,t||[]));return!r||typeof r.then!="function"?E.resolve(r):r}catch(i){return H(i)}},currentTransaction:{get:function(){return S.trans||null}},waitFor:function(e,t){var n=E.resolve(typeof e=="function"?Be.ignoreTransaction(e):e).timeout(t||6e4);return S.trans?S.trans.waitFor(n):n},Promise:E,debug:{get:function(){return he},set:function(e){ni(e,e==="dexie"?function(){return!0}:yi)}},derive:nt,extend:Q,props:Ze,override:Qr,Events:Pt,on:Oe,liveQuery:Ci,extendObservabilitySet:Si,getByKeyPath:be,setByKeyPath:oe,delByKeyPath:Aa,shallowClone:Zr,deepClone:Et,getObjectDiff:dr,cmp:X,asap:qr,minKey:Mn,addons:[],connections:ft,errnames:nr,dependencies:Wn,semVer:Pr,version:Pr.split(".").map(function(e){return parseInt(e)}).reduce(function(e,t,n){return e+t/Math.pow(10,n*2)})}));Be.maxKey=gt(Be.dependencies.IDBKeyRange);typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(Oe(mt,function(e){if(!me){var t;cn?(t=document.createEvent("CustomEvent"),t.initCustomEvent(Ce,!0,!0,e)):t=new CustomEvent(Ce,{detail:e}),me=!0,dispatchEvent(t),me=!1}}),addEventListener(Ce,function(e){var t=e.detail;me||an(t)}));function an(e){var t=me;try{me=!0,Oe.storagemutated.fire(e)}finally{me=t}}var me=!1;if(typeof BroadcastChannel<"u"){var $r=new BroadcastChannel(Ce);Oe(mt,function(e){me||$r.postMessage(e)}),$r.onmessage=function(e){e.data&&an(e.data)}}else if(typeof self<"u"&&typeof navigator<"u"){Oe(mt,function(e){try{me||(typeof localStorage<"u"&&localStorage.setItem(Ce,JSON.stringify({trig:Math.random(),changedParts:e})),typeof self.clients=="object"&&An([],self.clients.matchAll({includeUncontrolled:!0}),!0).forEach(function(t){return t.postMessage({type:Ce,changedParts:e})}))}catch{}}),typeof addEventListener<"u"&&addEventListener("storage",function(e){if(e.key===Ce){var t=JSON.parse(e.newValue);t&&an(t.changedParts)}});var Mr=self.document&&navigator.serviceWorker;Mr&&Mr.addEventListener("message",Wo)}function Wo(e){var t=e.data;t&&t.type===Ce&&an(t.changedParts)}E.rejectionMapper=Ka;ni(he,yi);class Go extends vr{constructor(){super("SoundBoardDB");$(this,"sample");this.version(1).stores({sample:"filename"})}}const mr=class{constructor(){$(this,"_database");this._database=new Go}static get instance(){if(!this._instance)throw new Error("AppStore not Initialized");return this._instance}static init(){this._instance=new mr}async getSampleBlob(t){return await this._database.sample.get({filename:t}).then(n=>n==null?void 0:n.data)??void 0}async getAllSampleFileNames(){return await this._database.sample.toCollection().keys()}async addSampleFromFile(t){return await this._database.sample.put({filename:t.name,data:t})}async addSample(t){return await this._database.sample.put(t)}async deleteSampleByName(t){return await this._database.sample.where({filename:t}).delete()}};let fe=mr;$(fe,"_instance");const Yo="/soundbored/assets/AUUGHHH-a37a8d1e.mp3",Xo="/soundbored/assets/scratch-ce8e44bd.wav",Qo="/soundbored/assets/sweet_pea-8dd5ad83.wav";class ki{static decodeArrayBuffer(t){var n=t.length/4*3,r=new ArrayBuffer(n);return this.decode(t,r),r}static removePaddingChars(t){return this._keyStr.indexOf(t.charAt(t.length-1))==64?t.substring(0,t.length-1):t}static decode(t,n){t=this.removePaddingChars(t),t=this.removePaddingChars(t);var r=Math.floor(t.length/4*3),i,a,o,s,u,l,c,f,h=0,y=0;for(i=n?new Uint8Array(n):new Uint8Array(r),t=t.replace(/[^A-Za-z0-9\+\/\=]/g,""),h=0;h<r;h+=3)u=this._keyStr.indexOf(t.charAt(y++)),l=this._keyStr.indexOf(t.charAt(y++)),c=this._keyStr.indexOf(t.charAt(y++)),f=this._keyStr.indexOf(t.charAt(y++)),a=u<<2|l>>4,o=(l&15)<<4|c>>2,s=(c&3)<<6|f,i[h]=a,c!=64&&(i[h+1]=o),f!=64&&(i[h+2]=s);return i}}$(ki,"_keyStr","ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=");async function qo(e,t,n){return await fetch(`https://api.github.com/repos/${e}/${t}/contents/${n}`).then(i=>i.json()).then(i=>fetch(`https://api.github.com/repos/${e}/${t}/git/blobs/${i.sha}`)).then(i=>i.json()).catch(i=>console.error(i))}async function Jo(e){const r=await qo("tidalcycles","Dirt-Samples",e),i=ki.decodeArrayBuffer(r.content);return new Blob([i],{type:"audio/wav"})}async function Zo(){["https://dobrian.github.io/cmp/topics/sample-recording-and-playback-with-web-audio-api/freejazz.wav",Yo,Xo,Qo].forEach(async(t,n)=>{let r=t.split("/").at(-1);fetch(t).then(i=>i.blob()).then(async i=>{fe.instance.addSample({filename:r,data:i})})})}async function es(){["gabba/000_0.wav","birds/001_10.wav"].forEach(async e=>{Jo(e).then(async t=>{fe.instance.addSample({filename:e,data:t})})})}async function ts(){fe.init(),await Promise.all([Zo(),es()]),console.log("App Data Loaded")}class Ie extends ga{constructor(n,r=Object.is){super();$(this,"_value");$(this,"_eq");this._value=n,this._eq=r}get value(){return this._value}set value(n){if(!this._eq(this._value,n)){const r=this._value;this._value=n,this.fire(n,r)}}}class wt{static get instance(){if(!this._instance)throw new Error("AudioContext not initialized");return this._instance}static init(t){this._instance=new AudioContext,this.initialized.value=!0}}$(wt,"_instance"),$(wt,"initialized",new Ie(!1));class ns{constructor(t,n){$(this,"audio");$(this,"_splitter");$(this,"_audioOut");$(this,"_sampleHolder");$(this,"_analyser");$(this,"_playing",!1);this.audio=new AudioBufferSourceNode(t,n),this._splitter=new ChannelSplitterNode(t),this._analyser=new AnalyserNode(t),this._audioOut=new ChannelMergerNode(t),this._sampleHolder=new Float32Array(1),this.audio.addEventListener("ended",()=>{this._playing=!1})}get playbackPosition(){return this._analyser.getFloatTimeDomainData(this._sampleHolder),this._sampleHolder[0]}get playing(){return this._playing}loadBuffer(t){this.audio.buffer=new AudioBuffer({length:t.length,sampleRate:t.sampleRate,numberOfChannels:t.numberOfChannels+1});for(let n=0;n<t.numberOfChannels;n++)this.audio.buffer.copyToChannel(t.getChannelData(n),n);for(let n=0;n<t.length;n++)this.audio.buffer.getChannelData(t.numberOfChannels)[n]=n/t.length;this.audio.connect(this._splitter);for(let n=0;n<t.numberOfChannels;n++)this._splitter.connect(this._audioOut,n,n);this._splitter.connect(this._analyser,t.numberOfChannels)}get playbackRate(){return this.audio.playbackRate}start(...t){this._playing=!0,this.audio.start(...t)}stop(t){this.audio.stop(t)}connect(t,n){return this._audioOut.connect(t,n)}}function qe(e){const[t,n]=Le(e.value),r=a=>{n(()=>a)};return Hi(()=>{e.attach(r)}),qn(()=>{e.detach(r)}),[t,a=>{e.value=a}]}function Pi(){const[e]=qe(wt.initialized);return()=>e()?wt.instance:null}class rs{constructor(t="",n=""){$(this,"src");$(this,"label");$(this,"audioContext",new Ie(null));$(this,"_buffer",new Ie(new ArrayBuffer(0)));$(this,"_audioBuffer");$(this,"_playbackRate",new Ie(1));$(this,"_preservePitch",new Ie(!1));$(this,"onSrcUpdate",async t=>{if(!t)return;const n=await fe.instance.getSampleBlob(this.src.value);if(!n)throw new Error(`Sample '${this.src.value}' not found`);this._buffer.value=await n.arrayBuffer()});$(this,"onBufferUpdate",async()=>{var t;try{this._audioBuffer=await((t=this.audioContext.value)==null?void 0:t.decodeAudioData(this._buffer.value))}catch(n){console.error(n)}});this.src=new Ie(t),this.label=new Ie(n),this.src.attach(this.onSrcUpdate),this._buffer.attach(this.onBufferUpdate)}get audioBuffer(){if(!this._audioBuffer)throw new Error("No Audio Buffer loaded");return this._audioBuffer}get loaded(){return!!this._audioBuffer}get playbackRate(){return this._playbackRate}get preservePitch(){return this._preservePitch}dispose(){this.src.detach(this.onSrcUpdate)}loadBuffer(){this.src.fire(this.src.value)}}class Ti{}$(Ti,"samples",[{filename:"freejazz.wav",label:"Freejazz"},{filename:"AUUGHHH.mp3",label:"Auughhh"},{filename:"scratch.wav",label:"Scratch"},{filename:"gabba/000_0.wav",label:"Gabba"},{filename:"birds/001_10.wav",label:"Birdies"}]);const is=q("<div>Play audio by hitting the buttons</div>"),as=q('<div class="App flex flex-column justify-content-center"><div class="grid"><h1 class="col-12">SoundBored</h1><div class="col-12"><div class="parameterPanel grid grid-nogutter"></div></div><div class="col-12"><div class="grid grid-nogutter"></div></div></div></div>'),os=q('<div class="col-3"></div>'),ss=12;function us(){ts();const e=Pi();on(()=>{const s=e();s&&t.forEach(u=>{u.audioContext.value=s,u.loadBuffer()})});const t=Array(ss).fill(null).map((s,u)=>new rs("",`Sample ${u+1}`));Ti.samples.forEach(({filename:s,label:u},l)=>{t[l].src.value=s,t[l].label.value=u});const n=t.map(s=>()=>ve(gs,{model:s})),[r,i]=Le(0),[a,o]=Le(!0);return[ve(ps,{get show(){return a()},onClose:()=>{wt.init(),o(!1)},buttonText:"Ok",get children(){return is.cloneNode(!0)}}),(()=>{const s=as.cloneNode(!0),u=s.firstChild,l=u.firstChild,c=l.nextSibling,f=c.firstChild,h=c.nextSibling,y=h.firstChild;return j(f,ve(Is,{}),null),j(f,ve(ma,{get component(){return n[r()]}}),null),j(y,()=>t.map((p,d)=>(()=>{const v=os.cloneNode(!0);return j(v,ve(cs,{model:p,onClick:()=>{i(d)}})),v})())),s})()]}const ls=q('<div class="buttonPad"><canvas></canvas><button><div class="label"></div><div>&#9658;</div></button><button>&#9632;</button></div>'),cs=({model:e,onClick:t})=>{let n,r,i;const a=Pi();e.audioContext.value=a();const[o]=qe(e.playbackRate),[s]=qe(e.label);on(()=>{const l=o();i&&(i.audio.playbackRate.value=l)});function u(){const l=r.getContext("2d"),c=i.playbackPosition;l&&(l.clearRect(0,0,r.width,r.height),l.fillStyle="white",l.fillRect(0,0,r.width*c,r.height),i!=null&&i.playing?requestAnimationFrame(u):l.clearRect(0,0,r.width,r.height))}return(()=>{const l=ls.cloneNode(!0),c=l.firstChild,f=c.nextSibling,h=f.firstChild,y=f.nextSibling;Yt(l,"click",t,!0);const p=n;typeof p=="function"?Xt(p,l):n=l;const d=r;return typeof d=="function"?Xt(d,c):r=c,f.$$click=()=>{!a()||!e.loaded||(i==null||i.stop(),i=new ns(a(),{playbackRate:o()}),i.loadBuffer(e.audioBuffer),i.connect(a().destination),i.start(),u())},j(h,s),y.$$click=()=>{i&&e.loaded&&i.stop()},l})()};At(["click"]);const fs=q('<section class="modal"><div class="topbar flex flex-row-reverse"><button></button></div><div></div></section>'),hs=q('<div class="modal-overlay"></div>'),ds=q("<button></button>"),ps=e=>{let t,n;return[(()=>{const r=fs.cloneNode(!0),i=r.firstChild,a=i.firstChild,o=i.nextSibling,s=t;return typeof s=="function"?Xt(s,r):t=r,Yt(a,"click",e.onClose,!0),j(o,()=>e.children),j(r,(()=>{const u=ke(()=>!!e.buttonText);return()=>u()&&(()=>{const l=ds.cloneNode(!0);return Yt(l,"click",e.onClose,!0),j(l,()=>e.buttonText),l})()})(),null),re(()=>r.classList.toggle("hidden",!e.show)),r})(),(()=>{const r=hs.cloneNode(!0),i=n;return typeof i=="function"?Xt(i,r):n=r,re(()=>r.classList.toggle("hidden",!e.show)),r})()]};At(["click"]);const vs=q('<div class="col grid grid-nogutter"><div class="col-3"><label for="playbackRateControl">Playback speed</label><input id="playbackRateControl" type="range" min="0.01" step="0.01" max="2"></div><div class="col p-4"><div class="sampleDropZone"><div></div></div></div></div>'),ys=q('<input type="text" maxlength="12" class="label">'),ms=q('<div class="label"></div>'),gs=e=>{const[t,n]=qe(e.model.label),[r,i]=qe(e.model.playbackRate),[a,o]=qe(e.model.src),[s,u]=Le(!1);return(()=>{const l=vs.cloneNode(!0),c=l.firstChild,f=c.firstChild,h=f.nextSibling,y=c.nextSibling,p=y.firstChild,d=p.firstChild;return j(c,(()=>{const v=ke(()=>!!s());return()=>v()?(()=>{const g=ys.cloneNode(!0);return g.addEventListener("mouseleave",()=>u(!1)),g.$$input=_=>_.currentTarget.value&&n(_.currentTarget.value),re(()=>g.value=t()),g})():(()=>{const g=ms.cloneNode(!0);return g.$$click=()=>u(!0),j(g,t),g})()})(),f),h.$$click=v=>{v.detail>1&&i(1)},h.$$input=v=>i(v.currentTarget.valueAsNumber),h.style.setProperty("width","75%"),p.addEventListener("drop",v=>{if(v.preventDefault(),v.dataTransfer){const g=v.dataTransfer.getData("text/plain");o(g)}}),p.addEventListener("dragover",v=>{v.preventDefault(),v.dataTransfer&&(v.dataTransfer.dropEffect="link")}),d.style.setProperty("position","absolute"),d.style.setProperty("left","0.5em"),j(d,a),re(()=>h.value=r()),l})()};At(["input","click"]);const Gn=Symbol("store-raw"),_t=Symbol("store-node"),bs=Symbol("store-name");function Oi(e,t){let n=e[se];if(!n&&(Object.defineProperty(e,se,{value:n=new Proxy(e,xs)}),!Array.isArray(e))){const r=Object.keys(e),i=Object.getOwnPropertyDescriptors(e);for(let a=0,o=r.length;a<o;a++){const s=r[a];i[s].get&&Object.defineProperty(e,s,{enumerable:i[s].enumerable,get:i[s].get.bind(n)})}}return n}function De(e){let t;return e!=null&&typeof e=="object"&&(e[se]||!(t=Object.getPrototypeOf(e))||t===Object.prototype||Array.isArray(e))}function et(e,t=new Set){let n,r,i,a;if(n=e!=null&&e[Gn])return n;if(!De(e)||t.has(e))return e;if(Array.isArray(e)){Object.isFrozen(e)?e=e.slice(0):t.add(e);for(let o=0,s=e.length;o<s;o++)i=e[o],(r=et(i,t))!==i&&(e[o]=r)}else{Object.isFrozen(e)?e=Object.assign({},e):t.add(e);const o=Object.keys(e),s=Object.getOwnPropertyDescriptors(e);for(let u=0,l=o.length;u<l;u++)a=o[u],!s[a].get&&(i=e[a],(r=et(i,t))!==i&&(e[a]=r))}return e}function yr(e){let t=e[_t];return t||Object.defineProperty(e,_t,{value:t={}}),t}function Yn(e,t,n){return e[t]||(e[t]=Ki(n))}function ws(e,t){const n=Reflect.getOwnPropertyDescriptor(e,t);return!n||n.get||!n.configurable||t===se||t===_t||t===bs||(delete n.value,delete n.writable,n.get=()=>e[se][t]),n}function Di(e){if(Lr()){const t=yr(e);(t._||(t._=Ki()))()}}function _s(e){return Di(e),Reflect.ownKeys(e)}function Ki(e){const[t,n]=Le(e,{equals:!1,internal:!0});return t.$=n,t}const xs={get(e,t,n){if(t===Gn)return e;if(t===se)return n;if(t===wn)return Di(e),n;const r=yr(e),i=r.hasOwnProperty(t);let a=i?r[t]():e[t];if(t===_t||t==="__proto__")return a;if(!i){const o=Object.getOwnPropertyDescriptor(e,t);Lr()&&(typeof a!="function"||e.hasOwnProperty(t))&&!(o&&o.get)&&(a=Yn(r,t,a)())}return De(a)?Oi(a):a},has(e,t){return t===Gn||t===se||t===wn||t===_t||t==="__proto__"?!0:(this.get(e,t,e),t in e)},set(){return!0},deleteProperty(){return!0},ownKeys:_s,getOwnPropertyDescriptor:ws};function ne(e,t,n,r=!1){if(!r&&e[t]===n)return;const i=e[t],a=e.length;n===void 0?delete e[t]:e[t]=n;let o=yr(e),s;(s=Yn(o,t,i))&&s.$(()=>n),Array.isArray(e)&&e.length!==a&&(s=Yn(o,"length",a))&&s.$(e.length),(s=o._)&&s.$()}function Ri(e,t){const n=Object.keys(t);for(let r=0;r<n.length;r+=1){const i=n[r];ne(e,i,t[i])}}function As(e,t){if(typeof t=="function"&&(t=t(e)),t=et(t),Array.isArray(t)){if(e===t)return;let n=0,r=t.length;for(;n<r;n++){const i=t[n];e[n]!==i&&ne(e,n,i)}ne(e,"length",r)}else Ri(e,t)}function lt(e,t,n=[]){let r,i=e;if(t.length>1){r=t.shift();const o=typeof r,s=Array.isArray(e);if(Array.isArray(r)){for(let u=0;u<r.length;u++)lt(e,[r[u]].concat(t),n);return}else if(s&&o==="function"){for(let u=0;u<e.length;u++)r(e[u],u)&&lt(e,[u].concat(t),n);return}else if(s&&o==="object"){const{from:u=0,to:l=e.length-1,by:c=1}=r;for(let f=u;f<=l;f+=c)lt(e,[f].concat(t),n);return}else if(t.length>1){lt(e[r],t,[r].concat(n));return}i=e[r],n=[r].concat(n)}let a=t[0];typeof a=="function"&&(a=a(i,n),a===i)||r===void 0&&a==null||(a=et(a),r===void 0||De(i)&&De(a)&&!Array.isArray(a)?Ri(i,a):ne(e,r,a))}function Es(...[e,t]){const n=et(e||{}),r=Array.isArray(n),i=Oi(n);function a(...o){Li(()=>{r&&o.length===1?As(n,o[0]):lt(n,o)})}return[i,a]}const Xn=Symbol("store-root");function Ye(e,t,n,r,i){const a=t[n];if(e===a)return;if(!De(e)||!De(a)||i&&e[i]!==a[i]){if(e!==a){if(n===Xn)return e;ne(t,n,e)}return}if(Array.isArray(e)){if(e.length&&a.length&&(!r||i&&e[0]&&e[0][i]!=null)){let u,l,c,f,h,y,p,d;for(c=0,f=Math.min(a.length,e.length);c<f&&(a[c]===e[c]||i&&a[c]&&e[c]&&a[c][i]===e[c][i]);c++)Ye(e[c],a,c,r,i);const v=new Array(e.length),g=new Map;for(f=a.length-1,h=e.length-1;f>=c&&h>=c&&(a[f]===e[h]||i&&a[c]&&e[c]&&a[f][i]===e[h][i]);f--,h--)v[h]=a[f];if(c>h||c>f){for(l=c;l<=h;l++)ne(a,l,e[l]);for(;l<e.length;l++)ne(a,l,v[l]),Ye(e[l],a,l,r,i);a.length>e.length&&ne(a,"length",e.length);return}for(p=new Array(h+1),l=h;l>=c;l--)y=e[l],d=i&&y?y[i]:y,u=g.get(d),p[l]=u===void 0?-1:u,g.set(d,l);for(u=c;u<=f;u++)y=a[u],d=i&&y?y[i]:y,l=g.get(d),l!==void 0&&l!==-1&&(v[l]=a[u],l=p[l],g.set(d,l));for(l=c;l<e.length;l++)l in v?(ne(a,l,v[l]),Ye(e[l],a,l,r,i)):ne(a,l,e[l])}else for(let u=0,l=e.length;u<l;u++)Ye(e[u],a,u,r,i);a.length>e.length&&ne(a,"length",e.length);return}const o=Object.keys(e);for(let u=0,l=o.length;u<l;u++)Ye(e[o[u]],a,o[u],r,i);const s=Object.keys(a);for(let u=0,l=s.length;u<l;u++)e[s[u]]===void 0&&ne(a,s[u],void 0)}function Ss(e,t={}){const{merge:n,key:r="id"}=t,i=et(e);return a=>{if(!De(a)||!De(i))return i;const o=Ye(i,{[Xn]:a},Xn,n,r);return o===void 0?a:o}}function Cs(e){const[t,n]=Es([]);return on(ji(e,()=>{ks(Ci(e),t,n)})),t}function ks(e,t,n,r={key:"id"}){const i=e.subscribe(a=>n(Ss(a,r)));return qn(()=>"unsubscribe"in i?i.unsubscribe():i()),t}const Ps=q('<svg fill="currentColor" stroke-width="0" xmlns="http://www.w3.org/2000/svg"></svg>'),Ts=q("<title></title>");function Ii(e,t){const n=Xi(e.a,t);return(()=>{const r=Ps.cloneNode(!0);return Yr(r,n,!0,!0),j(r,()=>pa,null),j(r,(()=>{const i=ke(()=>!!t.title,!0);return()=>i()&&(()=>{const a=Ts.cloneNode(!0);return j(a,()=>t.title),a})()})(),null),re(i=>{const a=e.a.stroke,o={...t.style,overflow:"visible",color:t.color||"currentColor"},s=t.size||"1em",u=t.size||"1em",l=e.c;return a!==i._v$&&Xe(r,"stroke",i._v$=a),i._v$2=Gr(r,o,i._v$2),s!==i._v$3&&Xe(r,"height",i._v$3=s),u!==i._v$4&&Xe(r,"width",i._v$4=u),l!==i._v$5&&(r.innerHTML=i._v$5=l),i},{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0,_v$5:void 0}),r})()}function Os(e){return Ii({a:{viewBox:"0 0 24 24"},c:'<path d="M20 5h-9.586L8.707 3.293A.997.997 0 008 3H4c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h16c1.103 0 2-.897 2-2V7c0-1.103-.897-2-2-2zm-4 9h-3v3h-2v-3H8v-2h3V9h2v3h3v2z"/>'},e)}function Ds(e){return Ii({a:{viewBox:"0 0 24 24"},c:'<path d="M6 7H5v13a2 2 0 002 2h10a2 2 0 002-2V7H6zm4 12H8v-9h2v9zm6 0h-2v-9h2v9zm.618-15L15 2H9L7.382 4H3v2h18V4z"/>'},e)}const Ks=q('<div class="sampleExplorer col-3"><input id="fileExplorer" type="file" hidden multiple><div class="sampleExplorer-header relative"><span>Samples</span></div><div class="sampleExplorer-list"></div></div>'),Rs=q("<div><span></span></div>"),Is=()=>{const e=Cs(()=>fe.instance.getAllSampleFileNames()),[t,n]=Le(null);return(()=>{const r=Ks.cloneNode(!0),i=r.firstChild,a=i.nextSibling;a.firstChild;const o=a.nextSibling;return r.addEventListener("mouseleave",()=>n(null)),i.addEventListener("change",s=>{if(s.currentTarget.files)for(const u of s.currentTarget.files)fe.instance.addSampleFromFile(u)}),j(a,ve(Os,{class:"icon",onClick:()=>{var s;return(s=document.getElementById("fileExplorer"))==null?void 0:s.click()}}),null),j(o,ve(qi,{each:e,children:(s,u)=>(()=>{const l=Rs.cloneNode(!0),c=l.firstChild;return l.$$mouseover=()=>n(u),l.addEventListener("dragstart",f=>{var h;return(h=f.dataTransfer)==null?void 0:h.setData("text/plain",f.target.textContent??"")}),Xe(l,"draggable",!0),j(c,s),j(l,(()=>{const f=ke(()=>u()===t());return()=>f()&&ve(Ds,{class:"icon",onClick:async()=>confirm(`Delete '${s}' from sample bank?`)&&fe.instance.deleteSampleByName(s)})})(),null),re(f=>Wr(l,{"sampleExplorer-item relative":!0,selected:u()===t()},f)),l})()})),r})()};At(["mouseover"]);oa(()=>ve(us,{}),document.getElementById("root"));
